# Created by: Stas Timokhin <stast@bsdportal.ru>
# $FreeBSD$

PORTNAME=	eiskaltdcpp
PORTREVISION=	15
CATEGORIES=	net-p2p
PKGNAMESUFFIX=	-daemon

MAINTAINER=	ports@FreeBSD.org
COMMENT=	EiskaltDC++ client daemon

LICENSE=	GPLv3

LIB_DEPENDS=	libeiskaltdcpp.so:net-p2p/eiskaltdcpp-lib

MASTERDIR=	${.CURDIR}/../eiskaltdcpp-lib

USES=		cmake:insource gettext compiler:c++11-lib ssl

OPTIONS_SINGLE=	UI
OPTIONS_SINGLE_UI=	NOUI XMLRPC JSONRPC
OPTIONS_DEFAULT=	JSONRPC
UI_DESC=	Daemon user interface
NOUI_DESC=	Daemon without any UI
XMLRPC_DESC=	XMLRPC interface support (deprecated)
JSONRPC_DESC=	JSONRPC interface support

PLIST_FILES=	bin/${PORTNAME}${PKGNAMESUFFIX} \
		man/man1/${PORTNAME}${PKGNAMESUFFIX}.1.gz

CMAKE_ARGS+=	-DUSE_QT:BOOL=OFF
CMAKE_ARGS+=	-DUSE_GTK:BOOL=OFF
CMAKE_ARGS+=	-DCREATE_MO:BOOL=OFF

BUILD_WRKSRC=	${WRKSRC}/${PORTNAME}${PKGNAMESUFFIX}
INSTALL_WRKSRC=	${WRKSRC}/${PORTNAME}${PKGNAMESUFFIX}

XMLRPC_BROKEN=	xmlrpcserver.h:624:38: error: no member named 'getMethodList' in 'ServerThread'
XMLRPC_LIB_DEPENDS=	libxmlrpc++.so:net/xmlrpc-c
XMLRPC_CMAKE_ON=	-DXMLRPC_DAEMON:BOOL=ON -DJSONRPC_DAEMON:BOOL=OFF -DNO_UI_DAEMON:BOOL=OFF

JSONRPC_LIB_DEPENDS=	libjsoncpp.so:devel/jsoncpp
JSONRPC_CMAKE_ON=	-DXMLRPC_DAEMON:BOOL=OFF -DJSONRPC_DAEMON:BOOL=ON -DNO_UI_DAEMON:BOOL=OFF -DLOCAL_JSONCPP:BOOL=OFF

NOUI_CMAKE_ON=		-DXMLRPC_DAEMON:BOOL=OFF -DJSONRPC_DAEMON:BOOL=OFF -DNO_UI_DAEMON:BOOL=ON

.include "${MASTERDIR}/Makefile"
