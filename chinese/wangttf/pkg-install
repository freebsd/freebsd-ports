#!/bin/sh

if [ "$2" = "PRE-INSTALL" ]; then
  exit 0
fi

PKGNAME=$1
PREFIX=${PKG_PREFIX}
TTFM=${PREFIX}/bin/ttfm.sh

# No default kai & ming for wangttf.
FONTDIR=${PREFIX}/share/fonts/TrueType
FONTS="wcl-01.ttf wcl-02.ttf wcl-03.ttf wcl-04.ttf wcl-05.ttf \
       wcl-06.ttf wcl-07.ttf wcl-08.ttf wcl-09.ttf wcl-10.ttf"

if [ ! -x $TTFM ]; then
    echo "$TTFM not found!"
    exit 1
fi

rm -f $FONTDIR/$PKGNAME

if [ "X$WANT_CJK" != "X" ]; then
    # There's no CJK module now.
fi

if [ "X$WANT_GS6" != "X" ]; then
    for f in $FONTS; do
        $TTFM --add ghostscript6 $FONTDIR/$f
    done
    for f in $DEFAULTMING; do
        $TTFM --setdefault ghostscript6 $FONTDIR/$f
    done
    for f in $DEFAULTKAI; do
        $TTFM --setdefault_kai ghostscript6 $FONTDIR/$f
    done
    echo "ghostscript6" >> $FONTDIR/$PKGNAME
fi

if [ "X$WITHOUT_X" = "X" ]; then
    for f in $FONTS; do
        $TTFM --add xttfm $FONTDIR/$f
    done
    for f in $DEFAULTMING; do
        $TTFM --setdefault xttfm $FONTDIR/$f
    done
    for f in $DEFAULTKAI; do
        $TTFM --setdefault_kai xttfm $FONTDIR/$f
    done
    echo "xttfm" >> $FONTDIR/$PKGNAME
fi

exit 0
