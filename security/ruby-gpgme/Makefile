# Created by: Akinori MUSHA aka knu <knu@idaemons.org>
# $FreeBSD$

PORTNAME=	gpgme
PORTVERSION=	1.0.8
PORTREVISION=	2
CATEGORIES=	security ruby
MASTER_SITES=	${MASTER_SITE_RUBYFORGE}
MASTER_SITE_SUBDIR=	ruby-gpgme
PKGNAMEPREFIX=	${RUBY_PKGNAMEPREFIX}
DISTNAME=	ruby-${PORTNAME}-${PORTVERSION}
DIST_SUBDIR=	ruby

MAINTAINER=	ruby@FreeBSD.org
COMMENT=	A Ruby interface to GnuPG Made Easy (GPGME)

LIB_DEPENDS=	libgpgme.so:${PORTSDIR}/security/gpgme

OPTIONS_DEFINE=	DOCS EXAMPLES

USE_RUBY=	yes
USE_RUBY_EXTCONF=	yes
USE_RUBY_RDOC=	yes

INSTALL_TARGET=	site-install

DOCS=		doc
EXAMPLES=	examples/*
EXAMPLESDIR=	${RUBY_MODEXAMPLESDIR}
DOCSDIR=	${RUBY_MODDOCDIR}
PORTEXAMPLES=	*
PORTDOCS=	*
MAKE_ARGS=	INSTALL_PROG="${INSTALL_PROGRAM}" \
		INSTALL_DATA="${INSTALL_DATA}"

LICENSE=	LGPL21
LICENSE_FILE=	${WRKSRC}/COPYING.LESSER

.include <bsd.port.options.mk>

.if ${PORT_OPTIONS:MDOCS}
post-build:
	cd ${BUILD_WRKSRC}; ${RUBY_RDOC} lib
.endif

post-install:
	@${MKDIR} ${STAGEDIR}${RUBY_MODDOCDIR}
	@(cd ${WRKSRC}/ && ${COPYTREE_SHARE} ${DOCS} ${STAGEDIR}${RUBY_MODDOCDIR}/)

	@${MKDIR} ${STAGEDIR}${RUBY_MODEXAMPLESDIR}
.for f in ${EXAMPLES}
	${INSTALL_DATA} ${WRKSRC}/${f} ${STAGEDIR}${RUBY_MODEXAMPLESDIR}/
.endfor

.include <bsd.port.mk>
