PORTNAME=	kubo
DISTVERSIONPREFIX=	v
DISTVERSION=	0.29.0
PORTREVISION=	2
CATEGORIES=	sysutils
PKGNAMESUFFIX=	-go

MAINTAINER=	jhixson@FreeBSD.org
COMMENT=	IPFS implementation in Go
WWW=		https://github.com/ipfs/kubo

LICENSE=	MIT APACHE20
LICENSE_COMB=	dual
LICENSE_FILE_MIT=	${WRKSRC}/LICENSE-MIT
LICENSE_FILE_APACHE20=	${WRKSRC}/LICENSE-APACHE

USES=		cpe go:1.22,modules

CONFLICTS_INSTALL?=	ipfs-go-*

CPE_VENDOR=	protocol

GO_MODULE=	github.com/ipfs/kubo
GO_TARGET=	./cmd/ipfs:kubo

USE_RC_SUBR=	${PORTNAME}${PKGNAMESUFFIX}

SUB_FILES=	${FULLNAME}
SUB_LIST=	KUBO_USER=${KUBO_USER} \
		KUBO_GROUP=${KUBO_GROUP} \
		KUBO_HOME=${KUBO_HOME}
PLIST_SUB=	KUBO_USER=${KUBO_USER} \
		KUBO_GROUP=${KUBO_GROUP} \
		KUBO_HOME=${KUBO_HOME}

KUBO_USER?=	${FULLNAME}
KUBO_GROUP?=	${FULLNAME}
KUBO_HOME?=	/var/db/${FULLNAME}

USERS=		${KUBO_USER}
GROUPS=		${KUBO_GROUP}

FULLNAME=	${PORTNAME}${PKGNAMESUFFIX}

post-install:
	@${MKDIR} ${STAGEDIR}${KUBO_HOME}

.include <bsd.port.mk>
