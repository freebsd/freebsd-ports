#!/bin/sh -e
#
#       pre-configure script for Elm port to FreeBSD
#
# $FreeBSD$

[ -r /usr/include/inttypes.h ] && has_inttypes=define || has_inttypes=undef
cpp /usr/include/wchar.h | grep mbrlen && has_wchar=define || has_wchar=undef

d_shared_rev=${SO_REV:-$(awk '/SHAREDTAG:/{print $2}' ${WRKSRC}/hdrs/patchlevel.h)}

[ -d  ${WRKSRC}/shlib ] || mkdir ${WRKSRC}/shlib

case ${CFLAGS} in
*-g*)	DEBUG="-DDEBUG" ;;
*)	DEBUG= ;;
esac

cat >> ${CONFIG_PATH} << EOF
#!/bin/sh
# config.sh
# This file was produced by running the $0 script.

Log='\$Log'
Header='\$Header'
install_prefix='${PREFIX}'
bin='${PREFIX}/bin'
contains='grep'
cppstdin='/usr/bin/cpp'
cppminus=''
diff='/usr/bin/diff'
d_getopt='define'
d_memcpy='define'
d_symlink='define'
d_whoami='undef'
d_poll='define'
d_select='define'
i_sys_select='define'
d_mmap='define'
i_sys_socket='define'
d_connect_reopen='undef'
i_netdb='define'
i_netinet_in='define'
i_arpa_inet='define'
d_use_aton='define'
i_inttypes='${has_inttypes}'
d_nointtypes='undef'
n='-n'
c=''
orderlib='false'
ranlib=':'
ar='ar'
nm='nm'
package='elm2.4me+'
pager='builtin++'
use_builtin_pager='define'
startsh='#!/bin/sh'
define='define'
loclist='
basename
cat
chgrp
chmod
cp
dirname
echo
expr
egrep
grep
fgrep
head
ln
ls
make
mv
rm
sed
sleep
sort
diff
touch
tr
uniq
cut
'
expr='/bin/expr'
sed='/usr/bin/sed'
echo='/bin/echo'
cat='/bin/cat'
rm='/bin/rm'
mv='/bin/mv'
cp='/bin/cp'
tail=''
tr='/usr/bin/tr'
sort='/usr/bin/sort'
uniq='/usr/bin/uniq'
grep='/usr/bin/grep'
fgrep='/usr/bin/fgrep'
head='/usr/bin/head'
trylist='
Mcc
compress
cpp
date
diff
emacs
execmail
gencat
gpg
ispell
line
lint
lp
locale
lpr
metamail
mips
more
nroff
pack
pg
pgp
pmake
pr
rmail
sendmail
shar
smail
submit
tar
tbl
test
troff
gtroff
uname
uuname
vi
'
test='test'
inews=''
ispell='${LOCALBASE}/bin/ispell'
egrep='/usr/bin/egrep'
more='/usr/bin/more'
pg='pg'
Mcc='Mcc'
vi='/usr/bin/vi'
mailx=''
mail=''
cpp='/usr/bin/cpp'
perl=''
emacs='${LOCALBASE}/bin/emacs'
ls='/bin/ls'
rmail='/bin/rmail'
sendmail='/usr/sbin/sendmail'
shar='/usr/bin/shar'
smail='smail'
submit=''
tbl='/usr/bin/tbl'
troff='/usr/bin/troff'
nroff='/usr/bin/nroff'
uname='/usr/bin/uname'
uuname='/usr/bin/uuname'
line='line'
chgrp='/usr/bin/chgrp'
chmod='/bin/chmod'
lint='/usr/bin/lint'
sleep='/bin/sleep'
pr='/usr/bin/pr'
tar='/usr/bin/tar'
ln='/bin/ln'
lpr='/usr/bin/lpr'
lp='/usr/bin/lp'
touch='/usr/bin/touch'
make='/usr/bin/make'
make_sets_make='define'
date='/bin/date'
csh=''
pmake='pmake'
mips='false'
col=''
pack='pack'
compress='/usr/bin/compress'
execmail=''
gencat='/usr/bin/gencat'
libswanted='sun nls c_s'
noaddlib='yes'
c_date='Tue Aug 24 15:05:52 CEST 2004'
d_ascii='undef'
d_broke_ctype='undef'
d_calendar='define'
calendar='calendar'
d_chown_neg1='define'
d_content='undef'
d_crypt='define'
cryptlib='-lcrypt'
d_cuserid='undef'
d_disphost='define'
d_domname='define'
d_usegetdom='undef'
d_errlst='define'
d_flock='define'
d_dotlock='define'
d_fcntlock='undef'
has_flock='define'
has_fcntl='define'
d_ftruncate='define'
d_gethname='define'
d_douname='undef'
ign_hname=''
d_havetlib='define'
termlib='-ltermlib'
i_curses='undef'
i_term='define'
d_index='undef'
d_internet=''
d_ispell='define'
ispell_path='${LOCALBASE}/bin/ispell'
ispell_options='-x'
i_locale='define'
i_nl_types='define'
d_msgcat='define'
d_usenls=''
d_mallocvoid='define'
d_mboxedit='define'
metamail_path='${LOCALBASE}/bin/metamail'
d_8bitmime='define'
d_binarymime='undef'
d_dsn='define'
defsystemcharset='US-ASCII'
d_mmdf='undef'
d_newauto='define'
d_noaddfrom='define'
d_usedomain='undef'
d_noxheader='undef'
d_pidcheck='define'
d_ptem='undef'
d_putenv='define'
maxattempts='6'
d_setgid='define'
mailermode='2755'
d_sigvec='undef'
d_sigvectr='undef'
d_sigset='undef'
d_sighold='undef'
d_sigprocmask='define'
d_sigblock='undef'
d_waitpid='define'
d_sigaction='define'
d_strcspn='define'
d_strspn='define'
d_strpbrk='define'
d_strerror='define'
d_strftime='define'
d_strings='undef'
d_pwdinsys='undef'
strings='/usr/include/string.h'
includepath=''
d_strstr='define'
d_strtok='define'
d_subshell='define'
d_tempnam='define'
d_setlinebuf='define'
d_shared='define'
d_shared_rev='${d_shared_rev}'
d_dlopen_libs='define'
shared_list='${ELM_SHLIBS}'
shared_register='${ELM_SHLIBS}'
d_dynamic_main='define'
dynamic_opt='-rdynamic'
dlopen_lib=''
rpath_opt='-rpath '
soname_opt='-shared -Wl,-soname,'
soname_include_path='define'
tempnamo=''
tempnamc=''
d_termio='undef'
d_termios='define'
d_utimbuf='define'
d_vfork='define'
d_directory='define'
d_directyry_type='USE_DIRENT'
defbatsub='no subject (file transmission)'
defeditor='/usr/bin/vi'
editoropts=''
hostname='localhost'
phostname='hostname'
mydomain='.invalid'
autohostname='define'
i_memory='define'
i_time='define'
i_systime='define'
d_systimekernel='undef'
i_unistd='define'
i_utime='define'
i_sysutime='undef'
lib='${LIB_DIR}'
shlib='${SHLIB_DIR}'
etc='${CONF_DIR}'
stage_dir='${STAGE_DIR}'
build_package='undef'
libdirname='lib'
libc='/usr/lib/libc.so'
linepr='/usr/bin/lp'
maildir='/var/mail'
mailer='/usr/sbin/sendmail'
mailgrp='mail'
mansrc='${MAN1PREFIX}/man/man1'
catmansrc='${MAN1PREFIX}/man/cat1'
manext='.1'
manext_choice='.1'
catmanext='.1'
catmanext_choice='.1'
packed='n'
manroff='/usr/bin/nroff'
manroffopts=''
suffix=''
packer=''
optimize='${CFLAGS}'
ccflags='${DEBUG}'
picflag='-fPIC'
nopic=''
shared_extra=''
cppflags=''
ldflags='-s'
cc='${CC}'
libs=''
nametype='bsd'
d_passnames='define'
d_berknames='define'
d_usgnames='undef'
# passcat=''
rmttape='unknown-remote-tape-unit'
roff='/usr/bin/troff'
roffopts=''
sigtype='void'
spitshell='cat'
shsharp='true'
sharpbang='#!'
tmpdir='/tmp'
tzname_handling='TM_ZONE'
use_pmake='n'
xencf=''
xenlf=''
d_xenix='undef'
d_bsd='define'
locale='locale'
have_codeset='define'
d_pgp='define'
pgp='${LOCALBASE}/bin/pgp'
pgp2_path='${LOCALBASE}/bin/pgp'
pgp5_dir='${LOCALBASE}/bin'
gpg_path='${LOCALBASE}/bin/gpg'
special_path='/usr/bin'
special_path2='${PREFIX}/bin'
locale_dir='/usr/share/locale'
d_wchar='${has_wchar}'
d_wcwidth='${has_wchar}'
CONFIG=true
EOF

tee -a ${CONFIG_PATH} >> ${WRKSRC}/shared_libs/iconv/config.res << EOF
iconv_dir='${LOCALBASE}'
iconv_include_dir='${LOCALBASE}/include'
iconv_lib_dir='${LOCALBASE}/lib'
iconv_link='iconv'
EOF

tee -a ${CONFIG_PATH} >> ${WRKSRC}/shared_libs/tls/config.res << EOF
tls_dir='${OPENSSLBASE}'
tls_include_dir='${OPENSSLINC}'
tls_lib_dir='${OPENSSLLIB}'
EOF

exit 0
