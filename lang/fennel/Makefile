PORTNAME=	fennel
DISTVERSION=	0.10.0
PORTREVISION=	1
CATEGORIES=	lang
MASTER_SITES=	https://git.sr.ht/~technomancy/${PORTNAME}/archive/${DISTVERSION}${EXTRACT_SUFX}?dummy=/

MAINTAINER=	jrm@FreeBSD.org
COMMENT=	Lisp that compiles to Lua

LICENSE=	MIT
LICENSE_FILE=	${WRKSRC}/LICENSE

USES=		gmake lua:build

MAKE_ENV=	LUA=${LUA_CMD} \
		LUA_DIR=${LOCALBASE} \
		LUA_INCLUDE_DIR=${LUA_INCDIR} \
		STATIC_LUA_LIB=${LUA_LIBDIR}/liblua-${LUA_VER}.a

ALL_TARGET=	${PORTNAME}-bin ${PORTNAME}.lua

do-install:
	${INSTALL_SCRIPT} ${WRKSRC}/${PORTNAME}.lua ${STAGEDIR}${LUA_LIBDIR}
	${INSTALL_SCRIPT} ${WRKSRC}/${PORTNAME}view.lua ${STAGEDIR}${LUA_LIBDIR}
	${INSTALL_MAN} ${WRKSRC}/${PORTNAME}.1 ${STAGEDIR}${MANPREFIX}/man/man1
	${INSTALL_PROGRAM} ${WRKSRC}/${PORTNAME}-bin ${STAGEDIR}${PREFIX}/bin/${PORTNAME}

.include <bsd.port.mk>
