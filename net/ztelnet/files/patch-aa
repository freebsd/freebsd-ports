diff -uNr ../ztelnet/Config.generic ./Config.generic
--- ../ztelnet/Config.generic	Wed Sep 20 19:53:28 1995
+++ ./Config.generic	Sun Mar 15 06:01:32 1998
@@ -183,23 +183,22 @@
 	@echo " dynix3.0.12 dynix3.0.17"
 	@echo " ultrix3.1 ultrix4.0"
 	@echo " next1.0"
-	@echo " linux"
 
 4.4bsd 4.3reno:
 	make -f Makefile.generic ${WHAT} \
-		LIBS="-lutil -ltermcap ../libtelnet/libtelnet.a" \
+		LIBS="-lutil -ltermcap ../libtelnet/libtelnet.a ../zmodem/librzsz.a" \
 		LIBPATH="/lib/libc.a /usr/lib/libtermcap.a \
 				../libtelnet/libtelnet.a" \
 		DEST=${DESTDIR}/usr/bin \
 		DEFINES="-DLINEMODE -DTERMCAP -DKLUDGELINEMODE \
-			-DUSE_TERMIO -DDIAGNOSTICS" \
+			-DUSE_TERMIO -DDIAGNOSTICS -DHANGUL" \
 		INCLUDES="-I.." \
-		LIB_OBJ="gettytab.o" \
-		LIB_SRC="gettytab.c" \
+#		LIB_OBJ="gettytab.o" \
+#		LIB_SRC="gettytab.c" \
 		AR=ar ARFLAGS=cq RANLIB=ranlib \
-		VPATH=/usr/src/libexec/getty \
+#		VPATH=/usr/src/libexec/getty \
 		LIBEXEC=${DESTDIR}/usr/libexec \
-		CC="${CC}" LCCFLAGS="-O"
+		CC="${CC}" LCCFLAGS="-O2"
 
 4.3tahoe:
 	@echo $@ is untested... it may or may not work..."
@@ -360,7 +359,6 @@
 		DEST=${DESTDIR}/usr/ucb \
 		DEFINES="-DFILIO_H -DTERMCAP -DUSE_TERMIO \
 			-DKLUDGELINEMODE -DSTREAMS \
-			-DAUTHENTICATE -DENCRYPT \
 			-DDIAGNOSTICS " \
 		INCLUDES="-I.." \
 		LIB_OBJ="getent.o strerror.o setenv.o herror.o" \
@@ -486,28 +484,3 @@
 
 clean cleandir:
 	make -f Makefile.generic $@
-
-#
-# The DEFINE, BYPMS is added by Myeong Seok Park, which is for preventing
-# from annoying Linux-gcc compile errors! The DEFINE is also used to solve
-# portability problem with other operating systems!
-# In a sense to mentioned previously, these source files are compatible
-# to possible UNIX systems(I have not tested to other OSes yet ;<).
-# If you want to know modified parts of the source files by me, use grep 
-# command (eg. 'grep PMS ~ztelnet/* | less' ). I have no time to write 
-# notes for the modified parts...
-#
-
-linux:
-	make -f Makefile.generic WHAT=$@ LINUX=linux\
-		LIBS="-lncurses ../libtelnet/libtelnet.a" \
-		LIBPATH="/usr/lib/libc.a /usr/lib/libncurses.a \
-			../libtelnet/libtelnet.a" \
-		DEST=${DESTDIR}/usr/local \
-		DEFINES="-DSYSV_TERMIO -DHAS_GETTOS -DHAVE_fd_set \
-			-DMUST_ALIGN -DBYPMS -Dunix -DHAS_GETTOS \
-			-DLINEMODE -DKLUDGELINEMODE -DDIAGNOSTICS"\
-		INCLUDES="-I.." \
-		AR=ar ARFLAGS=ru RANLIB=ranlib \
-		LIBEXEC=${DEST}/bin \
-		CC="${CC}" LCCFLAGS="-O -traditional -fno-strict-prototype"
diff -uNr ../ztelnet/Makefile ./Makefile
--- ../ztelnet/Makefile	Tue Sep 19 20:02:01 1995
+++ ./Makefile	Wed Dec  3 05:42:19 1997
@@ -1,10 +1,11 @@
-CC=cc
+CC=gcc
 all:
-	cd zmodem; make CC="${CC}"
 	cd libtelnet; make CC="${CC}"
+	cd zmodem; make CC="${CC}"
 	cd telnet; make CC="${CC}"
 
 .DEFAULT:
-	cd zmodem; make $@ WHAT=${WHAT} CC="${CC}"
 	cd libtelnet; make $@ WHAT=${WHAT} CC="${CC}"
+	#cd zmodem; make $@ WHAT=${WHAT} CC="${CC}"
+	cd zmodem; make CC="${CC}"
 	cd telnet; make $@ WHAT=${WHAT} CC="${CC}"
diff -uNr ../ztelnet/README.LINUX.ks ./README.LINUX.ks
--- ../ztelnet/README.LINUX.ks	Wed Sep 20 21:41:15 1995
+++ ./README.LINUX.ks	Thu Jan  1 00:00:00 1970
@@ -1,74 +0,0 @@
-=================================
- ztel-lnx.tgz: ztelnet for Linux
-=================================
-
-* 설치법
---------
-1. make linux
-2. mv ./telnet/telnet ~/bin/ztelnet
-
-* 사용상 주의사항
------------------
-1. 호스트 접속후 escape 문자는 ^] (CTRL+])입니다.
-2. escape 후에 set bin을 해줘야지 파일 전송시 에러가 안납니다. 
-3. 다시 remote 호스트로 돌아가려면 그냥 enter를 치세요.
-4. set bin을 해서 화면이 깨지는 경우에는 아예 ztelnet -8 <host>
-   해서 접속해 보세요..
-5. 한글 입출력이 되면 set bin이 이미 설정된것입니다.
-6. 기타의 사용법은 escape 후의 ztelnet> 모드에서 help를 쳐보세요.
-
-* 초보자를 위한 사용예
-----------------------
-myhost: telnet -8 nowcom.co.kr                     # -8 옵션은 set bin
-nowcom: ... (자료실로 이동) ...     
-nowcom: dn <자료번호>                              # 자료 보내기
-nowcom: ... (zmodem protocol을 써서 자료 전송) ...
-nowcom: ^]                                         # escape
-ztelnet> rz                                        # 자료 받기
-ztelnet> help                                      # 기타 도움말
-ztelnet> <리턴>                                    # 다시 나우콤
-nowcom: 
-
-* 개발자를 위한 유의 사항
--------------------------
-1. Config.generic 파일을 보시면 여러가지의 DEFINE이 있습니다. 제가 UNIX 
-   환경을 잘 모르다 보니 제대로 DEFINE을 한것인지 잘 모르겠습니다. 못 
-   미더우신 분들은 Config.generic에서 linux: 부분의 DEFINE을 더하거나 빼시면 
-   됩니다.
-2. 허준혁님의 소스를 손상시키지 않기위해 BYPMS라는 DEFINE을 만들었습니다.
-   BYPMS가 맘에 안들지만 이를 정의한 것은 두가지 이유때문입니다.
-   * 리눅스 gcc의 컴파일 에러를 없애기 위해 :)
-   * 미래의 누군가가 리눅스뿐만 아니라 다른 시스템에 쉽게 porting또는
-     upgrade가 가능하게 하려고 ;<   
-3. Linux와 다른 UNIX의 makefile과 cc등이 달라서 그런지 SUN 4.1.?에서 
-   컴파일 해봤더니 에러 투성이네요.. 에고 Linux가 아닌 분들은 허준혁님의
-   원래 소스를 받아다가 설치하시기를..
-   아마 gcc와 GNU make가 설치되어 있다면 에러가 안날지도..
-4. 시간이 없어서 고친 부분을 명시하지는 못하지만 제가 고친 부분은
-		grep PMS ~ztelnet/* | less
-   로 확인할 수 있습니다.
-5. 이전에는 Config.local을 사용했었는데 아예 Config.generic에 linux 부분을
-   넣어버렸습니다. 어느정도 리눅스 환경이 고려되었다고 믿기 때문입니다.
-
-참고 사항
----------
-1. 이 프로그램은 공짜지만 저자들의 허락없이는 상업적인 용도로 이용될 수
-   없습니다.
-2. ztelnet의 원저자는 허준혁님입니다. 그 소스는
-   ftp://dangun.kaist.ac.kr/???/ztelnet.tar.gz
-   입니다.
-3. Linux용 ztelnet은 아직 다른 시스템과 호환이 안되기 때문에 이름이 다릅니다.
-   ftp://romance.kaist.ac.kr/pub/linux/network/ztel-lnx.tgz
-   가 그 소스 파일입니다.
-4. 에고 우리나라에서도 공짜로 좀 좋은 프로그램 만들어서 배포해주는
-   사람이 많이 생겼으면 좋겠군요.. 
-
-* ztelnet을 만드신 허준혁님께 감사드립니다..
-* Linux porting:  1995. 4. 23.
-* Minor revision: 1995. 9. 20.
-________________________________________________________________
-  Park Myeong Seok, Dept. of Chem. Eng., KAIST, 305-701, Korea 
-  BioProcess Lab. (Tel. +82-42-869-3967)                      
-  E-mail: pms@romance.kaist.ac.kr/mspark@chiak.kaist.ac.kr     
-================================================================
-
diff -uNr ../ztelnet/README.ks ./README.ks
--- ../ztelnet/README.ks	Sun Feb 12 14:44:25 1995
+++ ./README.ks	Tue Apr 25 01:25:34 1995
@@ -7,19 +7,23 @@
 > Install방법
 1. tar xvf ztelnet.tar
 2. cd ztelnet
-3. make sun4.1 (다른 machine일 경우에는 그에 해당하는 target을 지정
-		target없이 make하면 가능한 target을 알 수 있다.) 
-4. ztelnet/telnet/telnet 이 새로 생기는 실행 화일
+3. cd zmodem
+4. make bsd (다른 machine일 경우에는 그에 해당하는 target을 지정
+		- target없이 make하면 가능한 target을 알 수 있다.) 
+5. cd ..
+6. make sun4.1 (다른 machine일 경우에는 그에 해당하는 target을 지정
+		- target없이 make하면 가능한 target을 알 수 있다.) 
+7. ztelnet/telnet/telnet 이 새로 생기는 실행 화일
 
 > Down/Up방법
 telnet으로 BBS(천리안 하이텔 나우콤등)에 접속한뒤
-down/up준비를 한뒤 escape 문자 ( default는 Ctrl-'[' )를 
+down/up준비를 한뒤 escape 문자 ( default는 Ctrl-']' )를 
 입력하여 telnet command 명령으로 빠져 나온다.
 binary상태가 아니면 "set bin" 한다.
 "rz" 혹은 "sz" 한다.
 
 현재 sun계열의 컴퓨터에서만 test를 해보았습니다.
-그리고 몇개의 중간 노드를 거쳐 접속해도 완벽하게
+그리고 몇개의 중간 노드를 거쳐 접속해도 
 up/down이 됩니다.
 
 문제점은 다운 중간에 Nice하게 강제로 끝내는 것이 
@@ -30,15 +34,16 @@
 	1995. 2. 12
 	허준혁 jhheo@dangun.kaist.ac.kr
 --
-                    ________
-   ////|\\\\       / Nice   \
-    | . . |       /  To      \
-   O|  ^  |O   oO \ Meet you!/
-    |  V  |  .'    \________/
-    \_____/
+                  ________        ///|\\\\
+  ////|\\\\      / Nice   \ Oo   ////|\\\\\
+   | . . |      /  To      \  `.///_. ._\\\\ 
+  O|  ^  |O  oO \ Meet you!/   ///   ^   \\\\ 
+   |  V  | .'    \________/   ////| /O\ |\\\\\
+   \_____/                   //// \_____/ \\\\\
+            ---------------> \\\\         /////
 
-If you ask me "what are you living for ?"
-I will just smile......
+the good time's gone!
+ remember coming soon!
 
        CSD KAIST 
        the E-mail address 
diff -uNr ../ztelnet/arpa/tel-lnx.h ./arpa/tel-lnx.h
--- ../ztelnet/arpa/tel-lnx.h	Sat Apr 22 17:17:21 1995
+++ ./arpa/tel-lnx.h	Thu Jan  1 00:00:00 1970
@@ -1,4 +0,0 @@
-#include "/usr/include/arpa/telnet.h"
-#define TELOPT_ENVIRON  36      /* Environment variables */
-#define    ENV_VALUE       0
-#define    ENV_VAR       1
diff -uNr ../ztelnet/libtelnet/Makefile.generic ./libtelnet/Makefile.generic
--- ../ztelnet/libtelnet/Makefile.generic	Wed Sep 20 19:52:44 1995
+++ ./libtelnet/Makefile.generic	Wed Dec  3 05:00:37 1997
@@ -19,32 +19,24 @@
 #	@(#)Makefile.generic	5.5 (Berkeley) 3/1/91
 #
 
-LIB=	libtelnet.a
-SRCS=	auth.c encrypt.c genget.c \
+LIB=    libtelnet.a
+SRCS=   auth.c encrypt.c genget.c \
 	misc.c enc_des.c \
 	setenv.c getent.c strdup.c strcasecmp.c \
 	strchr.c strrchr.c strftime.c strerror.c \
 	${LIB_SRC}
 
-OBJS=	auth.o encrypt.o genget.o \
+OBJS=   auth.o encrypt.o genget.o \
 	misc.o enc_des.o \
 	${LIB_OBJ}
 
-ifeq (linux,${LINUX})
-TELNET_H=	../arpa/tel-lnx.h
-CFLAGS=	${LCCFLAGS} ${INCLUDES} ${DEFINES}
-else
-TELNET_H=	../arpa/telnet.h
-CFLAGS=	-O ${DEFINES} ${INCLUDES}
-endif
+TELNET_H= ../arpa/telnet.h
+
+CFLAGS= -O2 ${DEFINES} ${INCLUDES}
 
 ${LIB}: ${OBJS}
 	rm -f ${LIB}
-ifeq (linux,${LINUX})
-	${AR} ${ARFLAGS} ${LIB} ${OBJS}
-else
 	${AR} ${ARFLAGS} ${LIB} `lorder ${OBJS} | tsort`
-endif
 	@if [ ${RANLIB} != NONE ]; \
 		then echo ${RANLIB} ${LIB}; ${RANLIB} ${LIB}; fi
 
diff -uNr ../ztelnet/libtelnet/strdup.c ./libtelnet/strdup.c
--- ../ztelnet/libtelnet/strdup.c	Mon Mar 25 22:14:21 1991
+++ ./libtelnet/strdup.c	Wed Dec  3 05:45:36 1997
@@ -28,7 +28,6 @@
 #include <string.h>
 #endif
 
-
 char *
 strdup(str)
 	char *str;
diff -uNr ../ztelnet/qbkpark ./qbkpark
--- ../ztelnet/qbkpark	Thu Jan  1 00:00:00 1970
+++ ./qbkpark	Sun Feb 12 15:48:38 1995
@@ -0,0 +1,32 @@
+From bkpark@netcom.com Sun Feb 12 15:37:46 1995
+Received: from netcom17.netcom.com by dangun.kaist.ac.kr (8.6.9H1/8.6.4)
+	id AAA21108; Mon, 13 Feb 1995 00:37:44 +0900
+Received: by netcom17.netcom.com (8.6.9/Netcom)
+	id HAA24753; Sun, 12 Feb 1995 07:38:54 -0800
+Date: Sun, 12 Feb 1995 07:38:54 -0800
+From: bkpark@netcom.com (Byung Kyu Park)
+Message-Id: <199502121538.HAA24753@netcom17.netcom.com>
+To: jhheo@dangun.kaist.ac.kr
+Subject: Asking about ztelnet.tar.gz
+Status: RO
+
+
+Hello!
+I was informed your ztelnet.tar.gz in kaist BBS.
+I received that by the use of anonymous FTP.
+But... I couldn't take a download to my PC.
+I think that is unix compression file. I don't know about it.
+I tried to get it after renaming as ztelnet.tar.
+And succeeded..
+I got it. 
+But, I can't extract the renamed file. (ztelnet.tar) in my PC (DOS).
+
+Could you tell me how to extract that? 
+Was there my fault in this process?
+Please informe me in detail...
+
+Very truly yours.
+Thank you!
+
+Byung Kyu Park.  (Sorry about poor English)
+
diff -uNr ../ztelnet/telnet/Makefile.generic ./telnet/Makefile.generic
--- ../ztelnet/telnet/Makefile.generic	Wed Sep 20 19:42:39 1995
+++ ./telnet/Makefile.generic	Wed Dec  3 08:58:33 1997
@@ -19,28 +19,22 @@
 #	@(#)Makefile.generic	5.5 (Berkeley) 3/1/91
 #
 
-INCLUDES=	-I..
-
-ifeq (linux,${LINUX})
-ARPA_TELNET=	../arpa/tel-lnx.h
-CFLAGS=	${LCCFLAGS} ${INCLUDES} ${DEFINES}
-else
-ARPA_TELNET=	../arpa/telnet.h
-CFLAGS=	-O ${INCLUDES} ${DEFINES}
-endif
+INCLUDES= -I..
+ARPA_TELNET= ../arpa/telnet.h
 
 SRCS=	commands.c main.c network.c ring.c \
 	sys_bsd.c telnet.c terminal.c \
 	utilities.c ${GETOPT_SRC}
 
+CFLAGS=	-O2 ${INCLUDES} ${DEFINES}
 
 ALLHC=	${SRCS} \
 	defines.h externs.h fdset.h general.h \
 	ring.h types.h
 
 OBJS=	authenc.o commands.o main.o network.o ring.o sys_bsd.o \
-	telnet.o terminal.o utilities.o ${GETOPT_OBJ} \
-	../zmodem/rz.o ../zmodem/sz.o
+	telnet.o terminal.o utilities.o ${GETOPT_OBJ}
+
 MAN=	telnet.0
 
 #
@@ -73,8 +67,8 @@
 	mkdep ${CFLAGS} `make clist`
 
 install: ${MAN} FRC
-	install -s -o bin -g bin -m 755 telnet ${LIBEXEC}
-	install -c -o bin -g bin -m 444 telnet.0 ${DEST}/man/cat1
+	install -s -o bin -g bin -m 755 telnet ${DEST}
+	install -c -o bin -g bin -m 444 telnet.0 ${DESTDIR}/usr/man/cat1
 
 lint: FRC ${SRCS}
 	lint ${CFLAGS} `make clist`
diff -uNr ../ztelnet/telnet/Makefile.generic.ORG ./telnet/Makefile.generic.ORG
--- ../ztelnet/telnet/Makefile.generic.ORG	Thu Jan  1 00:00:00 1970
+++ ./telnet/Makefile.generic.ORG	Wed Dec  3 00:54:17 1997
@@ -0,0 +1,90 @@
+#
+# Copyright (c) 1991 The Regents of the University of California.
+# All rights reserved.
+#
+# Redistribution and use in source and binary forms are permitted provided
+# that: (1) source distributions retain this entire copyright notice and
+# comment, and (2) distributions including binaries display the following
+# acknowledgement:  ``This product includes software developed by the
+# University of California, Berkeley and its contributors'' in the
+# documentation or other materials provided with the distribution and in
+# all advertising materials mentioning features or use of this software.
+# Neither the name of the University nor the names of its contributors may
+# be used to endorse or promote products derived from this software without
+# specific prior written permission.
+# THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED
+# WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
+# MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
+#
+#	@(#)Makefile.generic	5.5 (Berkeley) 3/1/91
+#
+
+INCLUDES= -I..
+ARPA_TELNET= ../arpa/telnet.h
+
+SRCS=	commands.c main.c network.c ring.c \
+	sys_bsd.c telnet.c terminal.c \
+	utilities.c ${GETOPT_SRC}
+
+CFLAGS=	-g ${INCLUDES} ${DEFINES}
+
+ALLHC=	${SRCS} \
+	defines.h externs.h fdset.h general.h \
+	ring.h types.h
+
+OBJS=	authenc.o commands.o main.o network.o ring.o sys_bsd.o \
+	telnet.o terminal.o utilities.o ${GETOPT_OBJ} \
+        ../zmodem/rz.o ../zmodem/sz.o
+MAN=	telnet.0
+
+#
+# These next three lines are not needed in 4.4BSD
+#
+.SUFFIXES: .0 .1
+.1.0:
+	nroff -man -h $< > $@
+
+all: telnet
+
+telnet:	${OBJS} ${LIBPATH}
+	${CC} -o $@ ${CFLAGS} ${OBJS} ${LIBS}
+
+clean: FRC
+	rm -f ${OBJS} core errs l.errs telnet
+
+cleandir: clean
+	rm -f ${MAN} tags .depend
+
+clist:	FRC ${SRCS}
+	@for i in ${SRCS} ; \
+		do (echo ${DIRPATH}$$i); done
+
+hclist:	FRC ${ALLHC}
+	@for i in ${ALLHC} ; \
+		do (echo ${DIRPATH}$$i); done
+
+depend: FRC ${SRCS}
+	mkdep ${CFLAGS} `make clist`
+
+install: ${MAN} FRC
+	install -s -o bin -g bin -m 755 telnet ${DEST}
+	install -c -o bin -g bin -m 444 telnet.0 ${DESTDIR}/usr/man/cat1
+
+lint: FRC ${SRCS}
+	lint ${CFLAGS} `make clist`
+
+tags: FRC ${SRCS}
+	ctags `make hclist`
+
+FRC:
+
+authenc.o: defines.h externs.h general.h ring.h types.h ${ARPA_TELNET}
+commands.o: defines.h externs.h general.h ring.h types.h ${ARPA_TELNET}
+main.o: defines.h externs.h ring.h
+network.o: defines.h externs.h fdset.h ring.h ${ARPA_TELNET}
+ring.o: general.h ring.h
+sys_bsd.o: defines.h externs.h fdset.h ring.h types.h ${ARPA_TELNET}
+telnet.o: defines.h externs.h general.h ring.h types.h ${ARPA_TELNET}
+terminal.o: externs.h ring.h types.h ${ARPA_TELNET}
+tn3270.o: defines.h externs.h fdset.h general.h ring.h ${ARPA_TELNET}
+utilities.o: defines.h externs.h fdset.h general.h ring.h ${ARPA_TELNET}
diff -uNr ../ztelnet/telnet/commands.c ./telnet/commands.c
--- ../ztelnet/telnet/commands.c	Wed Sep 20 00:03:45 1995
+++ ./telnet/commands.c	Wed Dec  3 02:17:45 1997
@@ -93,6 +93,10 @@
 static int margc;
 static char *margv[20];
 
+    void send_wont();
+    void send_dont();
+    void send_will();
+    void send_do();
     static void
 makeargv()
 {
@@ -230,10 +234,8 @@
     int		nbyte;		/* Number of bytes to send this command */
     int		what;		/* Character to be sent (<0 ==> special) */
 };
+
 
-/* PMS
-extern int
-*/
 static int
 	send_esc P((void)),
 	send_help P((void)),
@@ -370,7 +372,6 @@
 send_docmd(name)
     char *name;
 {
-    void send_do();
     return(send_tncmd(send_do, "do", name));
 }
 
@@ -378,21 +379,18 @@
 send_dontcmd(name)
     char *name;
 {
-    void send_dont();
     return(send_tncmd(send_dont, "dont", name));
 }
     static int
 send_willcmd(name)
     char *name;
 {
-    void send_will();
     return(send_tncmd(send_will, "will", name));
 }
     static int
 send_wontcmd(name)
     char *name;
 {
-    void send_wont();
     return(send_tncmd(send_wont, "wont", name));
 }
 
@@ -590,11 +588,8 @@
     return 1;
 }
 
-/* PMS
-extern int togglehelp P((void));
-*/
-static int togglehelp P((void));
 
+static int togglehelp P((void));
 #if	defined(AUTHENTICATE)
 extern int auth_togdebug P((int));
 #endif
@@ -828,12 +823,8 @@
  */
 
 #ifdef	USE_TERMIO
-#ifdef BYPMS
-struct termios new_tc = { 0 };
-#else
 struct termio new_tc = { 0 };
 #endif
-#endif
 
 struct setlist {
     char *name;				/* name */
@@ -1559,9 +1550,6 @@
 	int	arg;
 };
 
-/* PMS
-extern void slc_help();
-*/
 static void slc_help();
 
 struct slclist SlcList[] = {
@@ -1640,15 +1628,13 @@
 
 extern struct env_lst *
 	env_define P((unsigned char *, unsigned char *));
-extern void
+static void
 	env_undefine P((unsigned char *)),
 	env_export P((unsigned char *)),
 	env_unexport P((unsigned char *)),
 	env_send P((unsigned char *)),
-	env_list P((void));
-
-/* PMS: extern is replaced by static */
-static	void env_help P((void));
+	env_list P((void)),
+	env_help P((void));
 
 struct envlist EnvList[] = {
     { "define",	"Define an environment variable",
@@ -2232,7 +2218,7 @@
     register struct hostent *host = 0;
     struct sockaddr_in sin;
     struct servent *sp = 0;
-    unsigned long temp, inet_addr();
+    unsigned long temp;/*, inet_addr();*/
     extern char *inet_ntoa();
 #if	defined(IP_OPTIONS) && defined(IPPROTO_IP)
     char *srp = 0, *strrchr();
@@ -2489,11 +2475,7 @@
 	envhelp[] =	"change environment variables ('environ ?' for more)",
 	modestring[] = "try to enter line or character mode ('mode ?' for more)";
 
-/* PMS
-extern int	help();
-*/
-
-static int help();
+static int	help();
 
 static Command cmdtab[] = {
 	{ "close",	closehelp,	bye,		1 },
diff -uNr ../ztelnet/telnet/externs.h ./telnet/externs.h
--- ../ztelnet/telnet/externs.h	Tue Sep 19 22:52:29 1995
+++ ./telnet/externs.h	Mon Mar 25 22:14:23 1991
@@ -35,18 +35,14 @@
 #include <sys/filio.h>
 #endif
 #ifdef	USE_TERMIO
-#ifndef BYPMS
 # ifndef	VINTR
-#endif /* PMS */
 #  ifdef SYSV_TERMIO
 #   include <sys/termio.h>
 #  else
 #   include <sys/termios.h>
 #   define termio termios
 #  endif
-#ifndef BYPMS
 # endif
-#endif /* PMS */
 #endif
 #if defined(NO_CC_T) || !defined(USE_TERMIO)
 # if !defined(USE_TERMIO)
@@ -315,11 +311,7 @@
 
 # else
 
-#ifdef BYPMS
-extern struct	termios new_tc;
-#else
 extern struct	termio new_tc;
-#endif /* PMS */
 
 # define termEofChar		new_tc.c_cc[VEOF]
 # define termEraseChar		new_tc.c_cc[VERASE]
diff -uNr ../ztelnet/telnet/main.c ./telnet/main.c
--- ../ztelnet/telnet/main.c	Tue Sep 19 20:54:56 1995
+++ ./telnet/main.c	Mon Mar 25 22:14:24 1991
@@ -132,7 +132,6 @@
 		case 'S':
 		    {
 #ifdef	HAS_GETTOS
-#ifndef BYPMS
 			extern int tos;
 
 			if ((tos = parsetos(optarg, "tcp")) < 0)
@@ -140,7 +139,6 @@
 					prompt, ": Bad TOS argument '",
 					optarg,
 					"; will try to use default TOS");
-#endif /* PMS */
 #else
 			fprintf(stderr,
 			   "%s: Warning: -S ignored, no parsetos() support.\n",
diff -uNr ../ztelnet/telnet/sys_bsd.c ./telnet/sys_bsd.c
--- ../ztelnet/telnet/sys_bsd.c	Tue Sep 19 23:35:50 1995
+++ ./telnet/sys_bsd.c	Wed Dec  3 02:35:18 1997
@@ -43,13 +43,16 @@
 #include "externs.h"
 #include "types.h"
 
-/* PMS: BYPMS is added */
-#if	defined(CRAY) || (defined(USE_TERMIO) && !defined(SYSV_TERMIO)) || defined(BYPMS)
+#if	defined(CRAY) || (defined(USE_TERMIO) && !defined(SYSV_TERMIO))
 #define	SIG_FUNC_RET	void
 #else
 #define	SIG_FUNC_RET	int
 #endif
 
+#ifdef  SIGINFO
+extern SIG_FUNC_RET ayt_status();
+#endif
+
 int
 	tout,			/* Output file descriptor */
 	tin,			/* Input file descriptor */
@@ -65,16 +68,9 @@
 # define old_tc ottyb
 
 #else	/* USE_TERMIO */
-
-#ifdef BYPMS
-struct	termios old_tc = { 0 };
-extern struct termios new_tc;
-#else
 struct	termio old_tc = { 0 };
 extern struct termio new_tc;
-#endif /* PMS */
 
-#ifndef BYPMS
 # ifndef	TCSANOW
 #  ifdef TCSETS
 #   define	TCSANOW		TCSETS
@@ -100,7 +96,6 @@
 #  endif
 # endif /* TCSANOW */
 #endif	/* USE_TERMIO */
-#endif /* PMS */
 
 static fd_set ibits, obits, xbits;
 
@@ -166,11 +161,11 @@
  *	1	Do add this character
  */
 
+void xmitAO(), xmitEL(), xmitEC(), intp(), sendbrk();
     int
 TerminalSpecialChars(c)
     int	c;
 {
-    void xmitAO(), xmitEL(), xmitEC(), intp(), sendbrk();
 
     if (c == termIntChar) {
 	intp();
@@ -382,11 +377,7 @@
     struct sgttyb sb;
     int lmode;
 #else	/* USE_TERMIO */
-#ifdef BYPMS
-    struct termios tmp_tc;
-#else
     struct termio tmp_tc;
-#endif /* PMS */
 #endif	/* USE_TERMIO */
     int onoff;
     int old;
diff -uNr ../ztelnet/telnet/utilities.c ./telnet/utilities.c
--- ../ztelnet/telnet/utilities.c	Tue Sep 19 21:41:41 1995
+++ ./telnet/utilities.c	Wed Dec  3 01:57:23 1997
@@ -40,6 +40,15 @@
 
 #include "externs.h"
 
+#ifdef SLC_NAME_OK
+#undef SLC_NAME_OK
+#define SLC_NAME_OK(x)  ( (x) < NSLC )
+#endif
+#ifdef TELOPT_OK
+#undef TELOPT_OK
+#define TELOPT_OK(x) ((x) <= TELOPT_LAST)
+#endif
+
 FILE	*NetTrace = 0;		/* Not in bss, since needs to stay */
 int	prettydump;
 
@@ -282,9 +291,6 @@
     register int i;
     char buf[512];
     extern int want_status_response;
-#ifdef BYPMS
-	unsigned int bypms;
-#endif /* PMS */
 
     if (showoptions || direction == 0 ||
 	(want_status_response && (pointer[0] == TELOPT_STATUS))) {
@@ -578,12 +584,7 @@
 	    case LM_SLC:
 		fprintf(NetTrace, "SLC");
 		for (i = 2; i < length - 2; i += 3) {
-#ifdef BYPMS
-			bypms = (unsigned int) pointer[i+SLC_FUNC];
-		    if (SLC_NAME_OK(bypms))
-#else
 		    if (SLC_NAME_OK(pointer[i+SLC_FUNC]))
-#endif /* PMS */
 			fprintf(NetTrace, " %s", SLC_NAME(pointer[i+SLC_FUNC]));
 		    else
 			fprintf(NetTrace, " %d", pointer[i+SLC_FUNC]);
@@ -672,12 +673,7 @@
 		    case WONT:	cp = "WONT"; goto common2;
 		    common2:
 			i++;
-#ifdef BYPMS
-			bypms = (unsigned int) pointer[i];
-			if (TELOPT_OK(bypms))
-#else
 			if (TELOPT_OK((int)pointer[i]))
-#endif /* PMS */
 			    fprintf(NetTrace, " %s %s", cp, TELOPT(pointer[i]));
 			else
 			    fprintf(NetTrace, " %s %d", cp, pointer[i]);
@@ -799,12 +795,7 @@
 	    break;
 
 	default:
-#ifdef BYPMS
-		bypms = (unsigned int) pointer[0];
- 		if (TELOPT_OK(bypms))
-#else	   
- 		if (TELOPT_OK(pointer[0]))
-#endif /* PMS */
+	    if (TELOPT_OK(pointer[0]))
 		fprintf(NetTrace, "%s (unknown)", TELOPT(pointer[0]));
 	    else
 		fprintf(NetTrace, "%d (unknown)", pointer[i]);
diff -uNr ../ztelnet/zmodem/Makefile ./zmodem/Makefile
--- ../ztelnet/zmodem/Makefile	Wed Sep 20 00:20:41 1995
+++ ./zmodem/Makefile	Wed Dec  3 05:48:19 1997
@@ -1,142 +1,19 @@
-# Makefile for Unix/Xenix rz and sz programs
-# the makefile is not too well tested yet
-CFLAGS= -c -O
-OBJS=sz.o rz.o
-SRCS= rbsb.c minirb.c zm.c zmr.c crctab.c crc.c zmodem.h
-ARCFILES= README rbsb.c gz *.t minirb.c zmodem.h \
-	zm.c zmr.c crctab.c sz.c rz.c mailer.rz crc.c
+LIB=    librzsz.a
+SRCS=  rz.c sz.c
 
-nothing:
-	@echo
-	@echo "Please study the #ifdef's in crctab.c, rbsb.c, rz.c and sz.c,"
-	@echo "make any necessary hacks for oddball or merged SYSV/BSD systems,"
-	@echo "then type 'make SYSTEM' where SYSTEM is one of:"
-	@echo
-	@echo "	posix	POSIX compliant systems"
-	@echo "	linux	LINUX systems"
-	@echo "	odt	SCO Open Desktop"
-	@echo "	sysvr4	SYSTEM 5.4 Unix, SCO Open Desktop"
-	@echo "	sysvr3	SYSTEM 5.3 Unix with mkdir(2)"
-	@echo "	sysv	SYSTEM 3/5 Unix"
-	@echo "	xenix	Xenix"
-	@echo "	x386	386 Xenix"
-	@echo "	bsd	Berkeley 4.x BSD, Ultrix, V7"
-	@echo "	tandy	Tandy 6000 Xenix"
-	@echo "	dnix	DIAB Dnix 5.2"
-	@echo "	dnix5r3	DIAB Dnix 5.3"
-	@echo "	amiga	3000UX running SVR4"
-	@echo "	POSIX	POSIX compliant systems (SCO Open Desktop, strict)"
-	@echo
-	@echo "	doc	Format the man pages with nroff"
-	@echo
+OBJS=  rz.o sz.o \
+	${LIB_OBJ}
 
-usenet:doc
-	shar -c -a -n rzsz -o /tmp/rzsz -l64 \
-	  README Makefile zmodem.h zm.c rz.c rbsb.c \
-	 crc.c crctab.c minirb.c mailer.rz zmr.c *.doc gz sz.c *.t 
+CFLAGS= -O2 ${DEFINES} ${INCLUDES}
 
-shar:doc
-	shar -c README Makefile zmodem.h zm.c \
-	 zmr.c sz.c rz.c crctab.c \
-	 mailer.rz crc.c rbsb.c minirb.c *.doc gz *.t >/tmp/rzsz 
+${LIB}: ${OBJS}
+	rm -f ${LIB}
+	${AR} ${ARFLAGS} ${LIB} `lorder ${OBJS} | tsort`
+	@if [ ${RANLIB} != NONE ]; \
+		then echo ${RANLIB} ${LIB}; ${RANLIB} ${LIB}; fi
 
-unixforum: shar
-	compress /tmp/rzsz.sh
+clean cleandir:
+	rm -f *.o ${LIB} core a.out
 
-unix:
-	undos $(ARCFILES)
-
-dos:
-	todos $(ARCFILES)
-
-doc:rz.doc sz.doc crc.doc minirb.doc
-
-minirb.doc:minirb.1
-	nroff -man minirb.1 | col  >minirb.doc
-
-rz.doc:rz.1
-	nroff -man rz.1 | col  >rz.doc
-
-sz.doc:sz.1
-	nroff -man sz.1 | col  >sz.doc
-
-crc.doc:crc.1
-	nroff -man crc.1 | col  >crc.doc
-
-zoo: doc
-	-rm -f /tmp/rzsz.zoo
-	zoo ah /tmp/rzsz README Makefile zmodem.h zm.c sz.c rz.c \
-	 mailer.rz crctab.c rbsb.c *.doc \
-	 zmr.c crc.c gz *.t minirb.c
-	touch /tmp/rzsz.zoo
-	chmod og-w /tmp/rzsz.zoo
-	mv /tmp/rzsz.zoo /u/t/yam
-	-rm -f rzsz.zip
-	zip rzsz readme mailer.rz makefile zmodem.h zm.c sz.c rz.c
-	zip rzsz crctab.c rbsb.c *.doc
-	zip rzsz zmr.c crc.c gz *.t minirb.c
-	mv rzsz.zip /u/t/yam
-
-tar:doc
-	tar cvf /tmp/rzsz.tar README Makefile zmodem.h zm.c sz.c rz.c \
-	 mailer.rz crctab.c rbsb.c \
-	 zmr.c crc.c *.1 *.doc gz *.t minirb.c
-
-tags:
-	ctags sz.c rz.c zm.c zmr.c rbsb.c
-
-clean:
-	rm -f *.o
-
-xenix: 
-	$(CC) $(CFLAGS) -M0 -K -i -DUSG -DNFGVMIN -DREADCHECK sz.c
-	$(CC) $(CFLAGS) -M0 -K -i -DUSG -DMD rz.c
-
-x386:
-	$(CC) $(CFLAGS) -DUSG -DMD sz.c 
-	$(CC) $(CFLAGS) -DUSG -DNFGVMIN -DREADCHECK rz.c
-
-sysv:
-	$(CC) $(CFLAGS) -DUSG -DMD sz.c
-	$(CC) $(CFLAGS) -DUSG -DSV -DNFGVMIN rz.c
-
-sysvr3 ultrix3.1:
-	$(CC) $(CFLAGS) -DUSG -DMD=2 sz.c
-	$(CC) $(CFLAGS) -DSV -DUSG -DNFGVMIN rz.c
-
-sysvr4 ultrix4.0:
-	$(CC) $(CFLAGS) -DUSG -DMD=2 sz.c
-	$(CC) $(CFLAGS) -DSV -DUSG rz.c
-
-odt:
-	$(CC) $(CFLAGS) -strict -W2 -n -DUSG -DMD=2 sz.c
-	$(CC) $(CFLAGS) -strict -W2 -n -DUSG -DREADCHECK rz.c
-
-linux posix:
-	$(CC) $(CFLAGS) -DPOSIX -DMD=2 sz.c
-	$(CC) $(CFLAGS) -DPOSIX rz.c
-
-POSIX:
-	@echo "Well, stricter, as in *safer sex* ..."
-	$(CC) $(CFLAGS) -posix -W2 -DPOSIX -DMD=2 sz.c
-	$(CC) $(CFLAGS) -posix -W2 -DPOSIX rz.c
-
-bsd 4.4bsd 4.3reno 4.3tahoe 4.3bsd sun3.5 sun4.0 sun4.0.3c sun4.1:
-	$(CC) $(CFLAGS) -DMD=2 -Dstrchr=index -DV7 sz.c
-	$(CC) $(CFLAGS) -DV7 -DNFGVMIN rz.c
-
-tandy:
-	$(CC) $(CFLAGS) -n -DUSG -DMD -DT6K sz.c
-	$(CC) $(CFLAGS) -n -DUSG -DMD -DT6K rz.c
-
-dnix:
-	$(CC) $(CFLAGS) -DUSG -DMD sz.c
-	$(CC) $(CFLAGS) -DSV -DUSG -DNFGVMIN -DREADCHECK rz.c
-
-dnix5r3:
-	$(CC) $(CFLAGS) -DUSG -DMD=2 sz.c
-	$(CC) $(CFLAGS) -DUSG -DSV -DNFGVMIN -DREADCHECK rz.c
-
-amiga:
-	$(CC) $(CFLAGS) -DUSG -DNFGVMIN -g sz.c
-	$(CC) $(CFLAGS) -DUSG -DSV -DNFGVMIN -g rz.c
+rz.o : zmodem.h
+sz.o : zmodem.h
diff -uNr ../ztelnet/zmodem/Makefile.old ./zmodem/Makefile.old
--- ../ztelnet/zmodem/Makefile.old	Thu Jan  1 00:00:00 1970
+++ ./zmodem/Makefile.old	Wed Dec  3 04:04:23 1997
@@ -0,0 +1,141 @@
+# Makefile for Unix/Xenix rz and sz programs
+# the makefile is not too well tested yet
+CFLAGS= -c
+OBJS=sz.o rz.o
+SRCS= rbsb.c minirb.c zm.c zmr.c crctab.c crc.c zmodem.h
+ARCFILES= README rbsb.c gz *.t minirb.c zmodem.h \
+	zm.c zmr.c crctab.c sz.c rz.c mailer.rz crc.c
+
+nothing:
+	@echo
+	@echo "Please study the #ifdef's in crctab.c, rbsb.c, rz.c and sz.c,"
+	@echo "make any necessary hacks for oddball or merged SYSV/BSD systems,"
+	@echo "then type 'make SYSTEM' where SYSTEM is one of:"
+	@echo
+	@echo "	posix	POSIX compliant systems"
+	@echo "	odt	SCO Open Desktop"
+	@echo "	sysvr4	SYSTEM 5.4 Unix, SCO Open Desktop"
+	@echo "	sysvr3	SYSTEM 5.3 Unix with mkdir(2)"
+	@echo "	sysv	SYSTEM 3/5 Unix"
+	@echo "	xenix	Xenix"
+	@echo "	x386	386 Xenix"
+	@echo "	bsd	Berkeley 4.x BSD, Ultrix, V7"
+	@echo "	tandy	Tandy 6000 Xenix"
+	@echo "	dnix	DIAB Dnix 5.2"
+	@echo "	dnix5r3	DIAB Dnix 5.3"
+	@echo "	amiga	3000UX running SVR4"
+	@echo "	POSIX	POSIX compliant systems (SCO Open Desktop, strict)"
+	@echo
+	@echo "	doc	Format the man pages with nroff"
+	@echo
+
+usenet:doc
+	shar -c -a -n rzsz -o /tmp/rzsz -l64 \
+	  README Makefile zmodem.h zm.c rz.c rbsb.c \
+	 crc.c crctab.c minirb.c mailer.rz zmr.c *.doc gz sz.c *.t 
+
+shar:doc
+	shar -c README Makefile zmodem.h zm.c \
+	 zmr.c sz.c rz.c crctab.c \
+	 mailer.rz crc.c rbsb.c minirb.c *.doc gz *.t >/tmp/rzsz 
+
+unixforum: shar
+	compress /tmp/rzsz.sh
+
+unix:
+	undos $(ARCFILES)
+
+dos:
+	todos $(ARCFILES)
+
+doc:rz.doc sz.doc crc.doc minirb.doc
+
+minirb.doc:minirb.1
+	nroff -man minirb.1 | col  >minirb.doc
+
+rz.doc:rz.1
+	nroff -man rz.1 | col  >rz.doc
+
+sz.doc:sz.1
+	nroff -man sz.1 | col  >sz.doc
+
+crc.doc:crc.1
+	nroff -man crc.1 | col  >crc.doc
+
+zoo: doc
+	-rm -f /tmp/rzsz.zoo
+	zoo ah /tmp/rzsz README Makefile zmodem.h zm.c sz.c rz.c \
+	 mailer.rz crctab.c rbsb.c *.doc \
+	 zmr.c crc.c gz *.t minirb.c
+	touch /tmp/rzsz.zoo
+	chmod og-w /tmp/rzsz.zoo
+	mv /tmp/rzsz.zoo /u/t/yam
+	-rm -f rzsz.zip
+	zip rzsz readme mailer.rz makefile zmodem.h zm.c sz.c rz.c
+	zip rzsz crctab.c rbsb.c *.doc
+	zip rzsz zmr.c crc.c gz *.t minirb.c
+	mv rzsz.zip /u/t/yam
+
+tar:doc
+	tar cvf /tmp/rzsz.tar README Makefile zmodem.h zm.c sz.c rz.c \
+	 mailer.rz crctab.c rbsb.c \
+	 zmr.c crc.c *.1 *.doc gz *.t minirb.c
+
+tags:
+	ctags sz.c rz.c zm.c zmr.c rbsb.c
+
+clean:
+	rm -f *.o
+
+xenix: 
+	$(CC) $(CFLAGS) -M0 -K -i -DUSG -DNFGVMIN -DREADCHECK sz.c
+	$(CC) $(CFLAGS) -M0 -K -i -DUSG -DMD rz.c
+
+x386:
+	$(CC) $(CFLAGS) -DUSG -DMD sz.c 
+	$(CC) $(CFLAGS) -DUSG -DNFGVMIN -DREADCHECK rz.c
+
+sysv:
+	$(CC) $(CFLAGS) -DUSG -DMD sz.c
+	$(CC) $(CFLAGS) -DUSG -DSV -DNFGVMIN rz.c
+
+sysvr3 :
+	$(CC) $(CFLAGS) -DUSG -DMD=2 sz.c
+	$(CC) $(CFLAGS) -DSV -DUSG -DNFGVMIN rz.c
+
+sysvr4 :
+	$(CC) $(CFLAGS) -DUSG -DMD=2 sz.c
+	$(CC) $(CFLAGS) -DSV -DUSG rz.c
+
+odt:
+	$(CC) $(CFLAGS) -strict -W2 -n -DUSG -DMD=2 sz.c
+	$(CC) $(CFLAGS) -strict -W2 -n -DUSG -DREADCHECK rz.c
+
+posix:
+	$(CC) $(CFLAGS) -DPOSIX -DMD=2 sz.c
+	$(CC) $(CFLAGS) -DPOSIX rz.c
+
+POSIX:
+	@echo "Well, stricter, as in *safer sex* ..."
+	$(CC) $(CFLAGS) -posix -W2 -DPOSIX -DMD=2 sz.c
+	$(CC) $(CFLAGS) -posix -W2 -DPOSIX rz.c
+
+bsd:
+	$(CC) $(CFLAGS) -DMD=2 -Dstrchr=index -DV7 sz.c
+	$(CC) $(CFLAGS) -DV7 -DNFGVMIN rz.c
+
+tandy:
+	$(CC) $(CFLAGS) -n -DUSG -DMD -DT6K sz.c
+	$(CC) $(CFLAGS) -n -DUSG -DMD -DT6K rz.c
+
+dnix:
+	$(CC) $(CFLAGS) -DUSG -DMD sz.c
+	$(CC) $(CFLAGS) -DSV -DUSG -DNFGVMIN -DREADCHECK rz.c
+
+dnix5r3:
+	$(CC) $(CFLAGS) -DUSG -DMD=2 sz.c
+	$(CC) $(CFLAGS) -DUSG -DSV -DNFGVMIN -DREADCHECK rz.c
+
+amiga:
+	$(CC) $(CFLAGS) -DUSG -DNFGVMIN -g sz.c
+	$(CC) $(CFLAGS) -DUSG -DSV -DNFGVMIN -g rz.c
diff -uNr ../ztelnet/zmodem/rbsb.c ./zmodem/rbsb.c
--- ../ztelnet/zmodem/rbsb.c	Mon Apr 24 14:09:14 1995
+++ ./zmodem/rbsb.c	Wed Dec  3 04:44:14 1997
@@ -6,7 +6,7 @@
  */
 
 STATIC char *Copyr = "Copyright 1993 Omen Technology Inc All Rights Reserved";
-
+#define V7
 #ifdef V7
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -28,8 +28,6 @@
 #define OS "SYS III/V"
 #define MODE2OK
 #include <string.h>
-#include <stdlib.h>
-#include <unistd.h>
 #endif
 
 #ifdef POSIX
@@ -41,8 +39,6 @@
 #include <termios.h>
 #define OS "POSIX"
 #include <string.h>
-#include <stdlib.h>
-#include <unistd.h>
 #ifndef READCHECK
 #ifndef FIONREAD
 #define SV
@@ -70,6 +66,10 @@
 #define sendline(c) net_putchar(c & 0377)
 #define xsendline(c) net_putchar(c)
 
+/*----Appended by yongari to shut up compiler---*/
+STATIC zmputs();
+/*----------------------------------------------*/
+
 STATIC char linbuf[HOWMANY];
 STATIC int Lleft=0;		/* number of characters in linbuf */
 STATIC jmp_buf tohere;		/* For the interrupt on RX timeout */
@@ -84,8 +84,6 @@
 
 STATIC int Twostop;		/* Use two stop bits */
 
-/*PMS*/
-STATIC zmputs(char *s);
 
 /*
  *  The following uses an external rdchk() routine if available,
@@ -292,10 +290,8 @@
 STATIC init_rbsb()
 {
    int i;
-#ifdef LLITOUT
    Locmode = 0;
    Locbit = LLITOUT;
-#endif
    Lleft = 0;
 #ifdef ONEREAD
    Readnum = 1;	
diff -uNr ../ztelnet/zmodem/rz.c ./zmodem/rz.c
--- ../ztelnet/zmodem/rz.c	Mon Apr 24 14:28:22 1995
+++ ./zmodem/rz.c	Wed Dec  3 04:07:46 1997
@@ -1,5 +1,8 @@
-#define STATIC  static 
-
+/*------Appended by yongari------*/
+#define V7
+#define NFGVMIN
+/*-------------------------------*/
+#define STATIC  static
 #define VERSION "3.25 2-11-95"
 #define PUBDIR "/usr/spool/uucppublic"
 
@@ -82,6 +85,27 @@
 #include <errno.h>
 extern int errno;
 
+/*-----Appended by yongari to shut up compiler------*/
+STATIC usage();
+STATIC wcreceive();
+STATIC wcrxpn();
+STATIC wcrx();
+STATIC wcgetsec();
+STATIC procheader();
+STATIC openit();
+STATIC make_dirs();
+STATIC putsec();
+STATIC chkinvok();
+STATIC checkpath();
+STATIC tryz();
+STATIC rzfiles();
+STATIC rzfile();
+STATIC closeit();
+STATIC sys2();
+STATIC exec2();
+STATIC init_rz();
+/*--------------------------------------------------*/
+
 #define OK 0
 #define FALSE 0
 #define TRUE 1
@@ -195,10 +219,8 @@
 
 #include "zm.c"
 #include "zmr.c"
-STATIC int tryzhdrtype=ZRINIT;	/* Header type to send corresponding to Last rx close */
 
-/* PMS */
-#include "rz.h"
+STATIC int tryzhdrtype=ZRINIT;	/* Header type to send corresponding to Last rx close */
 
 /* called by signal interrupt or terminate to clean things up */
 STATIC void
@@ -339,8 +361,7 @@
 	fprintf(stderr,"Copyright 1993 Omen Technology INC All Rights Reserved\n");
 	fprintf(stderr,
 	"See rz.doc for option descriptions and licensing information.\n\n");
-	fprintf(stderr,"Ported into telnet by Heo, Junhyeok, 1994.3.28\n");
-	fprintf(stderr,"Linux porting by Park Myeong Seok,   1995.4.23\n");
+	fprintf(stderr,"Ported into telnet by Heo, Junhyeok 1994.3.28\n");
 	Exit(2);
 }
 
diff -uNr ../ztelnet/zmodem/rz.h ./zmodem/rz.h
--- ../ztelnet/zmodem/rz.h	Mon Apr 24 14:21:57 1995
+++ ./zmodem/rz.h	Thu Jan  1 00:00:00 1970
@@ -1,27 +0,0 @@
-#ifndef STATIC
-#define STATIC static
-#endif
-
-STATIC void bibi(int n);
-int rz(int argc, char *argv[]);
-STATIC usage(void);
-STATIC wcreceive(int argc, char **argp);
-STATIC wcrxpn(char *rpn);
-STATIC wcrx(void);
-STATIC wcgetsec(char *rxbuf, int maxtime);
-STATIC procheader(char *name);
-STATIC openit(char *name, char *openmode);
-STATIC make_dirs(register char *pathname);
-STATIC putsec(char *buf, register n);
-STATIC char *substr(register char *s, register char *t);
-STATIC chkinvok(char *s);
-STATIC checkpath(char *name);
-STATIC void ackbibi(void);
-STATIC tryz(void);
-STATIC rzfiles(void);
-STATIC rzfile(void);
-STATIC closeit(void);
-STATIC sys2(register char *s);
-STATIC exec2(register char *s);
-STATIC init_rz(void);
-
diff -uNr ../ztelnet/zmodem/sz.c ./zmodem/sz.c
--- ../ztelnet/zmodem/sz.c	Mon Apr 24 14:28:58 1995
+++ ./zmodem/sz.c	Wed Dec  3 05:53:22 1997
@@ -1,3 +1,8 @@
+/*-----Apended by yongari -----*/
+#define MD	2
+#define V7
+#define strchr index
+/*----------------------------*/
 #define STATIC  static
 #define VERSION "3.25 2-11-95"
 #define PUBDIR "/usr/spool/uucppublic"
@@ -57,7 +62,10 @@
 
 STATIC char *Copyrsz = "Copyright 1993 Omen Technology Inc All Rights Reserved";
 
-STATIC char *substr(), *getenv();
+/* Removed by yongari */
+/* STATIC char *substr(), *getenv(); */
+STATIC char *substr();
+char *getenv(const char *name);
 
 #define LOGFILE "/tmp/szlog"
 #define LOGFILE2 "szlog"
@@ -95,6 +103,26 @@
 
 #define HOWMANY 250
 
+/*------Appended by yongari to shut up compiler------*/
+STATIC wcsend();
+STATIC wcs();
+STATIC wctxpn();
+STATIC getnak();
+STATIC wctx();
+STATIC wcputsec();
+STATIC filbuf();
+STATIC usage();
+STATIC getzrxinit();
+STATIC sendzsinit();
+STATIC zsendfile();
+STATIC zsendfdata();
+STATIC getinsync();
+STATIC zsendcmd();
+STATIC chkinvok();
+STATIC countem();
+STATIC init_sz();
+/*-----------------------------------------------------*/
+
 STATIC int Zmodem=0;		/* ZMODEM protocol requested by receiver */
 unsigned Baudrate = 19200;		/* Default, set by first mode() call */
 STATIC unsigned Effbaud = 19200;
@@ -108,8 +136,7 @@
 #include "rbsb.c"	/* most of the system dependent stuff here */
 
 #include "crctab.c"
-/* PMS */
-#include "sz.h"
+
 STATIC int Filesleft;
 STATIC unsigned long Totalleft;
 
@@ -176,7 +203,9 @@
 STATIC unsigned long Lastsync;	/* Last offset to which we got a ZRPOS */
 STATIC int Beenhereb4;		/* How many times we've been ZRPOS'd here */
 STATIC int Ksendstr;		/* 1= Send esc-?-3-4-l to remote kermit */
-STATIC char *ksendbuf = "\033[?34l";
+/*-----Modified by yongri-----------*/
+/* STATIC char *ksendbuf = "\033[?34l"; */
+STATIC char ksendbuf[80];
 
 /*STATIC jmp_buf tohere;	/* For the interrupt on RX timeout */
 STATIC jmp_buf intrjmp;	/* For the interrupt on RX CAN */
@@ -225,6 +254,7 @@
 
 #include "zm.c"
 #include "zmr.c"
+
 sz(argc, argv)
 char *argv[];
 {
@@ -243,7 +273,6 @@
 		Znulls = atoi(cp);
 	if ((cp=getenv("SHELL")) && (substr(cp, "rsh") || substr(cp, "rksh")))
 		Restricted=TRUE;
-
 	chkinvok(argv[0]);
 
 	Rxtimeout = 600;
@@ -433,6 +462,7 @@
 	if (!Usevhdrs)  {
 		printf("\n\n\nPlease read the License Agreement in sz.doc\n");
 		fflush(stdout);
+		/* sleep(10); */
 		sleep(10);
 	}
 #endif
@@ -949,8 +979,7 @@
 	fprintf(stderr,"\nCopyright 1993 Omen Technology INC All Rights Reserved\n");
 	fprintf(stderr,
 	 "See sz.doc for option descriptions and licensing information.\n\n");
-	fprintf(stderr,"Ported into telnet by Heo, Junhyeok, 1994.3.28\n");
-	fprintf(stderr,"Linux porting by Park Myeong Seok,   1995.4.23\n");
+	fprintf(stderr,"\nPorted into telnet by Heo, junhyeok 1994.3.28\n");
 	Exit(3);
 }
 
@@ -1608,9 +1637,7 @@
     Lastsync=0;
     Beenhereb4=0;
     Ksendstr=0;
-/* By PMS
-    strcpy(ksendbuf,"\033[?34l");
-*/
+    strcpy(ksendbuf,"\033[?341l");
     Zctlesc=0;
     Nozmodem=0;
     Zrwindow=1400;
diff -uNr ../ztelnet/zmodem/sz.h ./zmodem/sz.h
--- ../ztelnet/zmodem/sz.h	Mon Apr 24 13:37:47 1995
+++ ./zmodem/sz.h	Thu Jan  1 00:00:00 1970
@@ -1,28 +0,0 @@
-#ifndef STATIC
-#define STATIC static
-#endif
-
-STATIC void bibi(int);
-STATIC void onintr(int);
-int sz(int argc, char *argv[]);
-STATIC void saybibi(void);
-STATIC wcsend(int argc, char *argp[]);
-STATIC wcs(char* oname);
-STATIC wctxpn(char *name);
-STATIC getnak(void);
-STATIC wctx(unsigned long flen);
-STATIC wcputsec(char* buf, int sectnum, int cseclen);
-STATIC filbuf(register char *buf, int count);
-STATIC zfilbuf(void);
-STATIC fooseek(FILE *fptr, unsigned long pos, int whence);
-STATIC char *substr(register char *s, register char *t);
-STATIC usage(void);
-STATIC getzrxinit(void);
-STATIC sendzsinit(void);
-STATIC zsendfile(char *buf, int blen);
-STATIC zsendfdata(void);
-STATIC getinsync(int flag);
-STATIC zsendcmd(char *buf, int blen);
-STATIC chkinvok(char *s);
-STATIC countem(int argc, register char **argv);
-STATIC init_sz(void);
diff -uNr ../ztelnet/zmodem/zm.c ./zmodem/zm.c
--- ../ztelnet/zmodem/zm.c	Mon Apr 24 14:31:24 1995
+++ ./zmodem/zm.c	Wed Dec  3 03:59:53 1997
@@ -72,10 +72,7 @@
 STATIC char Attn[ZATTNLEN+1];	/* Attention string rx sends to tx on err */
 STATIC char *Altcan;		/* Alternate canit string */
 
-STATIC int lastsent;	/* Last char we sent */
-
-/* PMS */
-#include "zm.h"
+STATIC lastsent;	/* Last char we sent */
 
 STATIC char *frametypes[] = {
 	"No Response to Error Correction Request",	/* -4 */
@@ -110,6 +107,23 @@
 
 STATIC char badcrc[] = "Bad CRC";
 
+/*---- Appended by yongari to shutu up compiler -----*/
+STATIC zsbh32();
+STATIC zsda32();
+STATIC zrdat32();
+STATIC garbitch();
+STATIC zrbhdr();
+STATIC zrbhd32();
+STATIC zrhhdr();
+STATIC zputhex();
+STATIC zsendline();
+STATIC zgethex();
+STATIC zgeth1();
+STATIC zdlread();
+STATIC noxrd7();
+/* STATIC unsigned long rclhdr();*/
+/*----------------------------------------------------*/
+
 /* Send ZMODEM binary header hdr of type type */
 STATIC zsbhdr(len, type, hdr)
 register char *hdr;
@@ -885,8 +899,7 @@
 }
 
 /* Recover a unsigned long integer from a header */
-STATIC unsigned long
-rclhdr(hdr)
+STATIC unsigned long rclhdr(hdr)
 register char *hdr;
 {
 	register unsigned long l;
diff -uNr ../ztelnet/zmodem/zm.h ./zmodem/zm.h
--- ../ztelnet/zmodem/zm.h	Mon Apr 24 14:27:16 1995
+++ ./zmodem/zm.h	Thu Jan  1 00:00:00 1970
@@ -1,26 +0,0 @@
-#ifndef STATIC
-#define STATIC static
-#endif
-
-STATIC zsbhdr(int len, int type, register char *hdr);
-STATIC zsbh32(int len, register char *hdr, int type, int flavour);
-STATIC zshhdr(int len, int type, register char *hdr);
-STATIC zsdata(register char *buf, int length, int frameend);
-STATIC zsda32(register char *buf, int length, int frameend);
-STATIC zrdata(register char *buf, int length);
-STATIC zrdat32(register char *buf, int length);
-STATIC garbitch(void);
-STATIC zgethdr(char* hdr, int eflag);
-STATIC zrbhdr(register char *hdr);
-STATIC zrbhd32(register char *hdr);
-STATIC zrhhdr(char *hdr);
-STATIC zputhex(register int c);
-STATIC zsendline(int c);
-STATIC zgethex(void);
-STATIC zgeth1(void);
-STATIC zdlread(void);
-STATIC noxrd7(void);
-STATIC stohdr(unsigned long pos);
-STATIC unsigned long rclhdr(register char *hdr);
-STATIC init_zm(void);
-
diff -uNr ../ztelnet/zmodem/zmodem.h ./zmodem/zmodem.h
--- ../ztelnet/zmodem/zmodem.h	Mon Apr 24 14:34:19 1995
+++ ./zmodem/zmodem.h	Wed Dec  3 04:01:31 1997
@@ -117,9 +117,9 @@
 /* Parameters for ZCOMMAND frame ZF0 (otherwise 0) */
 #define ZCACK1	1	/* Acknowledge, then do command */
 
-/* PMS
-unsigned long rclhdr();
-*/
+/*-----Modified by yongari to shut up compiler------*/
+/* unsigned long rclhdr(); */
+STATIC unsigned long rclhdr();
 
 /* Globals used by ZMODEM functions */
 extern Rxframeind;	/* ZBIN ZBIN32, or ZHEX type of frame */
diff -uNr ../ztelnet/zmodem/zmr.c ./zmodem/zmr.c
--- ../ztelnet/zmodem/zmr.c	Mon Apr 24 14:07:17 1995
+++ ./zmodem/zmr.c	Wed Dec  3 03:22:35 1997
@@ -38,9 +38,10 @@
  *
  *	ZMODEM RLE compression and decompression functions
  */
-/*PMS*/
-static zsdar32(char*, int, int);
-static zrdatr32(register char *buf, int length);
+/*--- Appended by yongari yo shut up compiler -----*/
+STATIC zsdar32();
+STATIC zrdatr32();
+/*-------------------------------------------------*/
 
 /* Send data subpacket RLE encoded with 32 bit FCS */
 STATIC zsdar32(buf, length, frameend)
