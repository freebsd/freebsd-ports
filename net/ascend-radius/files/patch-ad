--- radiusd.c.orig	Thu Sep 19 20:20:38 1996
+++ radiusd.c	Mon Sep 23 21:42:03 1996
@@ -40,6 +40,10 @@
 static char sccsid[] =
 "@(#)radiusd.c	1.17 Copyright 1992 Livingston Enterprises Inc";
 
+#if defined(_HAVE_PARAM_H)
+#include <sys/param.h>
+#endif
+
 #include	<sys/types.h>
 #include	<sys/socket.h>
 #include	<sys/file.h>
@@ -151,8 +155,10 @@
 #if defined(sys5) || defined(BSDI)
 extern char *crypt P__((CONST char *, CONST char *));
 #else
+#if ! (defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__NetBSD__))
 extern char *crypt P__((u_char *, u_char *));
 #endif
+#endif
 static void insertValuePair P__((VALUE_PAIR** list, VALUE_PAIR* pair));
 static VALUE_PAIR *copyValuePair P__((VALUE_PAIR* source));
 static AUTH_HDR *prepare_send_buffer P__((AUTH_REQ *authreq, int code));
@@ -1727,7 +1733,8 @@
      VALUE_PAIR	*checkList;
      VALUE_PAIR	*replyList;
 {
-	pairfree(authInfo->cutList);
+	if (authInfo->cutList != authInfo->authreq->request)
+		pairfree(authInfo->cutList);
 	authInfo->cutList = (VALUE_PAIR *)0;
 	pairfree( checkList );
 	pairfree( replyList );
