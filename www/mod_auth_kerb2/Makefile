# Created by: wollman
# $FreeBSD$

PORTNAME=	mod_auth_kerb
PORTVERSION=	5.4
PORTREVISION=	8
CATEGORIES=	www
MASTER_SITES=	SF/modauthkerb/${PORTNAME}/${PORTNAME}-${PORTVERSION}
PKGNAMEPREFIX=	${APACHE_PKGNAMEPREFIX}
PKGNAMESUFFIX=	2

MAINTAINER=	apache@FreeBSD.org
COMMENT=	Apache module for authenticating users with Kerberos v5

LICENSE=	MIT BSD3CLAUSE
LICENSE_COMB=	multi
LICENSE_FILE_MIT=	${WRKSRC}/LICENSE
LICENSE_FILE_BSD3CLAUSE=	${WRKSRC}/LICENSE

PORTSCOUT=	limit:^5.4

USE_APACHE=	22+
GNU_CONFIGURE=	yes
CONFIGURE_ARGS=	-with-krb5=${GSSAPIBASEDIR} --without-krb4

OPTIONS_SINGLE=		GSSAPI
OPTIONS_DEFAULT=	GSSAPI_BASE
OPTIONS_SINGLE_GSSAPI=	GSSAPI_BASE GSSAPI_HEIMDAL GSSAPI_MIT
GSSAPI_BASE_DESC=	Use Base version of GSS API
GSSAPI_HEIMDAL_DESC=	Use Heimdal implementation of GSS API
GSSAPI_MIT_DESC=	Use MIT implementation of GSS API
GSSAPI_DESC=		Use Base version of GSS API
GSSAPI_BASE_USES=	gssapi
GSSAPI_HEIMDAL_USES=	gssapi:heimdal
GSSAPI_MIT_USES=	gssapi:mit

.include <bsd.port.options.mk>

.if ${PORT_OPTIONS:MGSSAPI_BASE} && ${OSVERSION} < 903504
post-patch:
	${REINPLACE_CMD} -e 's|@KRB5_LDFLAGS@|@KRB5_LDFLAGS@ -lgssapi_krb5|' \
		${WRKSRC}/Makefile.in
.endif

.include <bsd.port.mk>
