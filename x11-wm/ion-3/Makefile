# New ports collection makefile for:	ion3-ds
# Date created:				18 June 2005
# Whom:					Ed Schouten <ed@fxq.nl>
#
# $FreeBSD$
#

PORTNAME=	ion-3rc
PORTVERSION=	20070902
CATEGORIES=	x11-wm
MASTER_SITES=	http://modeemi.fi/~tuomov/dl/:ion3 \
		${MASTER_SITE_LOCAL:S/$/:ion3/} \
		http://wannabehacker.com/src/:xinerama
MASTER_SITE_SUBDIR= philip/:ion3
DISTFILES=	${DISTNAME}${EXTRACT_SUFX}:ion3

MAINTAINER=	philip@FreeBSD.org
COMMENT=	The development version of the Ion window manager

RUN_DEPENDS=	run-mailcap:${PORTSDIR}/misc/mime-support

CONFLICTS=	ion-3ds-200*

USE_XLIB=	yes
USE_GMAKE=	yes
USE_LUA=	5.1
MAKE_ENV=	DEFINES="${IONDEFINES}"

.if defined(WITHOUT_NLS)
IONDEFINES+=	-DCF_NO_LOCALE
PLIST_SUB+=	NLS="@comment "
.else
USE_GETTEXT=	yes
PLIST_SUB+=	NLS=""
.endif
.if !defined(WITH_XINERAMA)
PLIST_SUB+=	XINERAMA="@comment "
.else
PLIST_SUB+=	XINERAMA=""
DISTFILES+=	mod_xinerama-20070719${EXTRACT_SUFX}:xinerama
.endif

MAN1=		ion3.1 pwm3.1
MANLANG=	"" fi cs

# Use our own system.mk, instead of the one generated by configure
do-configure:

.include <bsd.port.pre.mk>

post-extract:
.if defined(WITH_XINERAMA)
	@${MV} ${WRKDIR}/mod_xinerama-3 ${WRKSRC}/mod_xinerama
.endif

post-patch:
.if defined(NOPORTDOCS)
	@${REINPLACE_CMD} -e 's|^_install:|dont&|' ${WRKSRC}/Makefile
.endif
.if defined(WITHOUT_NLS)
	@${REINPLACE_CMD} -e 's| po | |' ${WRKSRC}/Makefile
.endif
.if defined(WITH_XINERAMA)
	@${REINPLACE_CMD} -e 's|^MODULE_LIST =|& mod_xinerama|' \
		${WRKSRC}/modulelist.mk
.endif

post-install:
.if defined(WITH_XINERAMA) && !defined(NOPORTDOCS)
	${INSTALL_DATA} ${WRKSRC}/mod_xinerama/README \
		${DOCSDIR}/README.mod_xinerama
.endif

.include <bsd.port.post.mk>
