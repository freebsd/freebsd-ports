# Created by: Marc van Woerkom <3d@FreeBSD.org>
# $FreeBSD: head/games/linux-quake3-demo/Makefile 340722 2014-01-22 17:00:46Z mat $

PORTNAME=	quake3
DISTVERSION=	1.11-6
PORTREVISION=	5
CATEGORIES=	games
MASTER_SITES=	GENTOO
PKGNAMEPREFIX=	linux-
PKGNAMESUFFIX=	-demo
DISTNAME=	linuxq3ademo-${DISTVERSION}.x86
EXTRACT_SUFX=	.gz.sh

MAINTAINER=	ports@FreeBSD.org
COMMENT=	Quake III Arena Demo

RESTRICTED=	Restrictive license by Loki Software
NO_CDROM=	${RESTRICTED}
NO_PACKAGE=	${RESTRICTED}

USE_LINUX=	yes
USE_LINUX_APPS+=dri
NO_BUILD=	yes
NO_WRKSUBDIR=	yes

DATADIR=	${PREFIX}/share/${PKGNAMEPREFIX}${PORTNAME}${PKGNAMESUFFIX}

SUB_FILES=	q3demo

OPTIONS_DEFINE=	DOCS

do-extract:
	@${MKDIR} ${WRKDIR}
	@cd ${WRKDIR} && ${TAIL} +165 ${_DISTDIR}/${DISTNAME}${EXTRACT_SUFX} | \
		${TAR} zxf -

do-install:
	${INSTALL_SCRIPT} ${WRKDIR}/q3demo ${STAGEDIR}${PREFIX}/bin
	@${MKDIR} ${STAGEDIR}${DATADIR}
	${INSTALL_PROGRAM} ${WRKSRC}/bin/x86/glibc-2.0/q3demo ${STAGEDIR}${DATADIR}
	${CP} -R ${WRKSRC}/demoq3 ${STAGEDIR}${DATADIR}
	${LN} -s ${LINUXBASE}/usr/X11R6/lib/libGL.so.1 ${STAGEDIR}${DATADIR}/libGL.so
	@${MKDIR} ${STAGEDIR}${DOCSDIR}
	${INSTALL_DATA} ${WRKSRC}/README ${STAGEDIR}${DOCSDIR}
	${CP} -R ${WRKSRC}/Help/* ${STAGEDIR}${DOCSDIR}

.include <bsd.port.mk>
