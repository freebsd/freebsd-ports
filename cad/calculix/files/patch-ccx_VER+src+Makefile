--- ccx_1.5/src/Makefile.orig	Sun Feb 19 09:28:07 2006
+++ ccx_1.5/src/Makefile	Mon Feb 20 16:58:56 2006
@@ -1,8 +1,10 @@
-CFLAGS = -Wall -O  -I ../../../SPOOLES.2.2 -DARCH="Linux" -DSPOOLES -DARPACK -DMATRIXSTORAGE
-FFLAGS = -Wall -O 
+CFLAGS += -O  -I. -I%%LOCALBASE%%/include -I%%LOCALBASE%%/include/spooles \
+		-DARCH="FreeBSD" -DSPOOLES -DARPACK -DMATRIXSTORAGE -DTAUCS	\
+		%%PTHREAD_CFLAGS%%
+FFLAGS += -O 
 
-CC=cc
-FC=g77
+CC?=%%CC%%
+FC?=%%FC%%
 
 .c.o :
 	$(CC) $(CFLAGS) -c $<
@@ -297,15 +299,13 @@
 OCCXC = $(SCCXC:.c=.o)
 OCCXMAIN = $(SCCXMAIN:.c=.o)
 
-DIR=../../../SPOOLES.2.2
+DIR=%%LOCALBASE%%/lib
 
-LIBS = \
-       $(DIR)/spooles.a \
-	../../../ARPACK/libarpack_INTEL.a \
+LIBS = -lspooles -larpack -ltaucs -llapack -lmetis %%BLAS_LIBS%%	\
        -lm
 
 ccx_1.5: $(OCCXMAIN) ccx_1.5.a  $(LIBS)
-	g77 -Wall -O  -o $@ $(OCCXMAIN) ccx_1.5.a  $(LIBS)
+	${FC} ${FFLAGS}  -o $@ $(OCCXMAIN) ccx_1.5.a %%PTHREAD_LIBS%% $(LIBS) -L$(DIR) -lcompat
 
 ccx_1.5.a: $(OCCXF) $(OCCXC)
 	ar vr $@ $?
