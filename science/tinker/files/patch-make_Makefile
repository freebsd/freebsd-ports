--- make/Makefile.orig	2021-09-29 02:42:24 UTC
+++ make/Makefile
@@ -87,9 +87,9 @@ APBS_LIBS = -lapbsmainroutines -lapbs -lmaloc -lapbsbl
 F77 = gfortran
 F77FLAGS = -c
 #OPTFLAGS = -Ofast -march=native -fopenmp
-OPTFLAGS = -Ofast -mssse3 -fopenmp
+OPTFLAGS = -Ofast $(PORT_SIMD_FLAGS) -fopenmp
 #OPTFLAGS = -Og -fbacktrace -fcheck=bounds -Wunused -Wmaybe-uninitialized
-LIBDIR = -L. -L$(TINKER_LIBDIR)/macos
+#LIBDIR = -L. -L$(TINKER_LIBDIR)/macos
 LIBS = 
 LIBFLAGS = -crusv
 RANLIB = ranlib -c
@@ -803,136 +803,136 @@ listing:
 	cat *.f *.c > tinker.txt
 
 rename_bin:
-	mv  alchemy.x    $(BINDIR)/alchemy
-	mv  analyze.x    $(BINDIR)/analyze
-	mv  anneal.x     $(BINDIR)/anneal
-	mv  archive.x    $(BINDIR)/archive
-	mv  bar.x        $(BINDIR)/bar
-	mv  correlate.x  $(BINDIR)/correlate
-	mv  critical.x   $(BINDIR)/critical
-	mv  crystal.x    $(BINDIR)/crystal
-	mv  diffuse.x    $(BINDIR)/diffuse
-	mv  distgeom.x   $(BINDIR)/distgeom
-	mv  document.x   $(BINDIR)/document
-	mv  dynamic.x    $(BINDIR)/dynamic
-	mv  freefix.x    $(BINDIR)/freefix
-	mv  gda.x        $(BINDIR)/gda
-	mv  intedit.x    $(BINDIR)/intedit
-	mv  intxyz.x     $(BINDIR)/intxyz
-	mv  minimize.x   $(BINDIR)/minimize
-	mv  minirot.x    $(BINDIR)/minirot
-	mv  minrigid.x   $(BINDIR)/minrigid
-	mv  mol2xyz.x    $(BINDIR)/mol2xyz
-	mv  molxyz.x     $(BINDIR)/molxyz
-	mv  monte.x      $(BINDIR)/monte
-	mv  newton.x     $(BINDIR)/newton
-	mv  newtrot.x    $(BINDIR)/newtrot
-	mv  nucleic.x    $(BINDIR)/nucleic
-	mv  optimize.x   $(BINDIR)/optimize
-	mv  optirot.x    $(BINDIR)/optirot
-	mv  optrigid.x   $(BINDIR)/optrigid
-	mv  path.x       $(BINDIR)/path
-	mv  pdbxyz.x     $(BINDIR)/pdbxyz
-	mv  polarize.x   $(BINDIR)/polarize
-	mv  poledit.x    $(BINDIR)/poledit
-	mv  potential.x  $(BINDIR)/potential
-	mv  prmedit.x    $(BINDIR)/prmedit
-	mv  protein.x    $(BINDIR)/protein
-	mv  pss.x        $(BINDIR)/pss
-	mv  pssrigid.x   $(BINDIR)/pssrigid
-	mv  pssrot.x     $(BINDIR)/pssrot
-	mv  radial.x     $(BINDIR)/radial
-	mv  saddle.x     $(BINDIR)/saddle
-	mv  scan.x       $(BINDIR)/scan
-	mv  sniffer.x    $(BINDIR)/sniffer
-	mv  spacefill.x  $(BINDIR)/spacefill
-	mv  spectrum.x   $(BINDIR)/spectrum
-	mv  superpose.x  $(BINDIR)/superpose
-	mv  testgrad.x   $(BINDIR)/testgrad
-	mv  testhess.x   $(BINDIR)/testhess
-	mv  testpair.x   $(BINDIR)/testpair
-	mv  testpol.x    $(BINDIR)/testpol
-	mv  testrot.x    $(BINDIR)/testrot
-	mv  testvir.x    $(BINDIR)/testvir
-	mv  timer.x      $(BINDIR)/timer
-	mv  timerot.x    $(BINDIR)/timerot
-	mv  torsfit.x    $(BINDIR)/torsfit
-	mv  valence.x    $(BINDIR)/valence
-	mv  vibbig.x     $(BINDIR)/vibbig
-	mv  vibrate.x    $(BINDIR)/vibrate
-	mv  vibrot.x     $(BINDIR)/vibrot
-	mv  xtalfit.x    $(BINDIR)/xtalfit
-	mv  xtalmin.x    $(BINDIR)/xtalmin
-	mv  xyzedit.x    $(BINDIR)/xyzedit
-	mv  xyzint.x     $(BINDIR)/xyzint
-	mv  xyzmol2.x    $(BINDIR)/xyzmol2
-	mv  xyzpdb.x     $(BINDIR)/xyzpdb
+	${BSD_INSTALL_PROGRAM}  alchemy.x    $(BINDIR)/alchemy
+	${BSD_INSTALL_PROGRAM}  analyze.x    $(BINDIR)/analyze
+	${BSD_INSTALL_PROGRAM}  anneal.x     $(BINDIR)/anneal
+	${BSD_INSTALL_PROGRAM}  archive.x    $(BINDIR)/archive
+	${BSD_INSTALL_PROGRAM}  bar.x        $(BINDIR)/bar
+	${BSD_INSTALL_PROGRAM}  correlate.x  $(BINDIR)/correlate
+	${BSD_INSTALL_PROGRAM}  critical.x   $(BINDIR)/critical
+	${BSD_INSTALL_PROGRAM}  crystal.x    $(BINDIR)/crystal
+	${BSD_INSTALL_PROGRAM}  diffuse.x    $(BINDIR)/diffuse
+	${BSD_INSTALL_PROGRAM}  distgeom.x   $(BINDIR)/distgeom
+	${BSD_INSTALL_PROGRAM}  document.x   $(BINDIR)/document
+	${BSD_INSTALL_PROGRAM}  dynamic.x    $(BINDIR)/dynamic
+	${BSD_INSTALL_PROGRAM}  freefix.x    $(BINDIR)/freefix
+	${BSD_INSTALL_PROGRAM}  gda.x        $(BINDIR)/gda
+	${BSD_INSTALL_PROGRAM}  intedit.x    $(BINDIR)/intedit
+	${BSD_INSTALL_PROGRAM}  intxyz.x     $(BINDIR)/intxyz
+	${BSD_INSTALL_PROGRAM}  minimize.x   $(BINDIR)/minimize
+	${BSD_INSTALL_PROGRAM}  minirot.x    $(BINDIR)/minirot
+	${BSD_INSTALL_PROGRAM}  minrigid.x   $(BINDIR)/minrigid
+	${BSD_INSTALL_PROGRAM}  mol2xyz.x    $(BINDIR)/mol2xyz
+	${BSD_INSTALL_PROGRAM}  molxyz.x     $(BINDIR)/molxyz
+	${BSD_INSTALL_PROGRAM}  monte.x      $(BINDIR)/monte
+	${BSD_INSTALL_PROGRAM}  newton.x     $(BINDIR)/newton
+	${BSD_INSTALL_PROGRAM}  newtrot.x    $(BINDIR)/newtrot
+	${BSD_INSTALL_PROGRAM}  nucleic.x    $(BINDIR)/nucleic
+	${BSD_INSTALL_PROGRAM}  optimize.x   $(BINDIR)/optimize
+	${BSD_INSTALL_PROGRAM}  optirot.x    $(BINDIR)/optirot
+	${BSD_INSTALL_PROGRAM}  optrigid.x   $(BINDIR)/optrigid
+	${BSD_INSTALL_PROGRAM}  path.x       $(BINDIR)/path
+	${BSD_INSTALL_PROGRAM}  pdbxyz.x     $(BINDIR)/pdbxyz
+	${BSD_INSTALL_PROGRAM}  polarize.x   $(BINDIR)/polarize
+	${BSD_INSTALL_PROGRAM}  poledit.x    $(BINDIR)/poledit
+	${BSD_INSTALL_PROGRAM}  potential.x  $(BINDIR)/potential
+	${BSD_INSTALL_PROGRAM}  prmedit.x    $(BINDIR)/prmedit
+	${BSD_INSTALL_PROGRAM}  protein.x    $(BINDIR)/protein
+	${BSD_INSTALL_PROGRAM}  pss.x        $(BINDIR)/pss
+	${BSD_INSTALL_PROGRAM}  pssrigid.x   $(BINDIR)/pssrigid
+	${BSD_INSTALL_PROGRAM}  pssrot.x     $(BINDIR)/pssrot
+	${BSD_INSTALL_PROGRAM}  radial.x     $(BINDIR)/radial
+	${BSD_INSTALL_PROGRAM}  saddle.x     $(BINDIR)/saddle
+	${BSD_INSTALL_PROGRAM}  scan.x       $(BINDIR)/scan
+	${BSD_INSTALL_PROGRAM}  sniffer.x    $(BINDIR)/sniffer
+	${BSD_INSTALL_PROGRAM}  spacefill.x  $(BINDIR)/spacefill
+	${BSD_INSTALL_PROGRAM}  spectrum.x   $(BINDIR)/spectrum
+	${BSD_INSTALL_PROGRAM}  superpose.x  $(BINDIR)/superpose
+	${BSD_INSTALL_PROGRAM}  testgrad.x   $(BINDIR)/testgrad
+	${BSD_INSTALL_PROGRAM}  testhess.x   $(BINDIR)/testhess
+	${BSD_INSTALL_PROGRAM}  testpair.x   $(BINDIR)/testpair
+	${BSD_INSTALL_PROGRAM}  testpol.x    $(BINDIR)/testpol
+	${BSD_INSTALL_PROGRAM}  testrot.x    $(BINDIR)/testrot
+	${BSD_INSTALL_PROGRAM}  testvir.x    $(BINDIR)/testvir
+	${BSD_INSTALL_PROGRAM}  timer.x      $(BINDIR)/timer
+	${BSD_INSTALL_PROGRAM}  timerot.x    $(BINDIR)/timerot
+	${BSD_INSTALL_PROGRAM}  torsfit.x    $(BINDIR)/torsfit
+	${BSD_INSTALL_PROGRAM}  valence.x    $(BINDIR)/valence
+	${BSD_INSTALL_PROGRAM}  vibbig.x     $(BINDIR)/vibbig
+	${BSD_INSTALL_PROGRAM}  vibrate.x    $(BINDIR)/vibrate
+	${BSD_INSTALL_PROGRAM}  vibrot.x     $(BINDIR)/vibrot
+	${BSD_INSTALL_PROGRAM}  xtalfit.x    $(BINDIR)/xtalfit
+	${BSD_INSTALL_PROGRAM}  xtalmin.x    $(BINDIR)/xtalmin
+	${BSD_INSTALL_PROGRAM}  xyzedit.x    $(BINDIR)/xyzedit
+	${BSD_INSTALL_PROGRAM}  xyzint.x     $(BINDIR)/xyzint
+	${BSD_INSTALL_PROGRAM}  xyzmol2.x    $(BINDIR)/xyzmol2
+	${BSD_INSTALL_PROGRAM}  xyzpdb.x     $(BINDIR)/xyzpdb
 
 rename_exe:
-	mv  alchemy.x    $(BINDIR)/alchemy.exe
-	mv  analyze.x    $(BINDIR)/analyze.exe
-	mv  anneal.x     $(BINDIR)/anneal.exe
-	mv  archive.x    $(BINDIR)/archive.exe
-	mv  bar.x        $(BINDIR)/bar.exe
-	mv  correlate.x  $(BINDIR)/correlate.exe
-	mv  critical.x   $(BINDIR)/critical.exe
-	mv  crystal.x    $(BINDIR)/crystal.exe
-	mv  diffuse.x    $(BINDIR)/diffuse.exe
-	mv  distgeom.x   $(BINDIR)/distgeom.exe
-	mv  document.x   $(BINDIR)/document.exe
-	mv  dynamic.x    $(BINDIR)/dynamic.exe
-	mv  freefix.x    $(BINDIR)/freefix.exe
-	mv  gda.x        $(BINDIR)/gda.exe
-	mv  intedit.x    $(BINDIR)/intedit.exe
-	mv  intxyz.x     $(BINDIR)/intxyz.exe
-	mv  minimize.x   $(BINDIR)/minimize.exe
-	mv  minirot.x    $(BINDIR)/minirot.exe
-	mv  minrigid.x   $(BINDIR)/minrigid.exe
-	mv  mol2xyz.x    $(BINDIR)/mol2xyz.exe
-	mv  molxyz.x     $(BINDIR)/molxyz.exe
-	mv  monte.x      $(BINDIR)/monte.exe
-	mv  newton.x     $(BINDIR)/newton.exe
-	mv  newtrot.x    $(BINDIR)/newtrot.exe
-	mv  nucleic.x    $(BINDIR)/nucleic.exe
-	mv  optimize.x   $(BINDIR)/optimize.exe
-	mv  optirot.x    $(BINDIR)/optirot.exe
-	mv  optrigid.x   $(BINDIR)/optrigid.exe
-	mv  path.x       $(BINDIR)/path.exe
-	mv  pdbxyz.x     $(BINDIR)/pdbxyz.exe
-	mv  polarize.x   $(BINDIR)/polarize.exe
-	mv  poledit.x    $(BINDIR)/poledit.exe
-	mv  potential.x  $(BINDIR)/potential.exe
-	mv  prmedit.x    $(BINDIR)/prmedit.exe
-	mv  protein.x    $(BINDIR)/protein.exe
-	mv  pss.x        $(BINDIR)/pss.exe
-	mv  pssrigid.x   $(BINDIR)/pssrigid.exe
-	mv  pssrot.x     $(BINDIR)/pssrot.exe
-	mv  radial.x     $(BINDIR)/radial.exe
-	mv  saddle.x     $(BINDIR)/saddle.exe
-	mv  scan.x       $(BINDIR)/scan.exe
-	mv  sniffer.x    $(BINDIR)/sniffer.exe
-	mv  spacefill.x  $(BINDIR)/spacefill.exe
-	mv  spectrum.x   $(BINDIR)/spectrum.exe
-	mv  superpose.x  $(BINDIR)/superpose.exe
-	mv  testgrad.x   $(BINDIR)/testgrad.exe
-	mv  testhess.x   $(BINDIR)/testhess.exe
-	mv  testpair.x   $(BINDIR)/testpair.exe
-	mv  testpol.x    $(BINDIR)/testpol.exe
-	mv  testrot.x    $(BINDIR)/testrot.exe
-	mv  testvir.x    $(BINDIR)/testvir.exe
-	mv  timer.x      $(BINDIR)/timer.exe
-	mv  timerot.x    $(BINDIR)/timerot.exe
-	mv  torsfit.x    $(BINDIR)/torsfit.exe
-	mv  valence.x    $(BINDIR)/valence.exe
-	mv  vibbig.x     $(BINDIR)/vibbig.exe
-	mv  vibrate.x    $(BINDIR)/vibrate.exe
-	mv  vibrot.x     $(BINDIR)/vibrot.exe
-	mv  xtalfit.x    $(BINDIR)/xtalfit.exe
-	mv  xtalmin.x    $(BINDIR)/xtalmin.exe
-	mv  xyzedit.x    $(BINDIR)/xyzedit.exe
-	mv  xyzint.x     $(BINDIR)/xyzint.exe
-	mv  xyzmol2.x    $(BINDIR)/xyzmol2.exe
-	mv  xyzpdb.x     $(BINDIR)/xyzpdb.exe
+	${BSD_INSTALL_PROGRAM}  alchemy.x    $(BINDIR)/alchemy.exe
+	${BSD_INSTALL_PROGRAM}  analyze.x    $(BINDIR)/analyze.exe
+	${BSD_INSTALL_PROGRAM}  anneal.x     $(BINDIR)/anneal.exe
+	${BSD_INSTALL_PROGRAM}  archive.x    $(BINDIR)/archive.exe
+	${BSD_INSTALL_PROGRAM}  bar.x        $(BINDIR)/bar.exe
+	${BSD_INSTALL_PROGRAM}  correlate.x  $(BINDIR)/correlate.exe
+	${BSD_INSTALL_PROGRAM}  critical.x   $(BINDIR)/critical.exe
+	${BSD_INSTALL_PROGRAM}  crystal.x    $(BINDIR)/crystal.exe
+	${BSD_INSTALL_PROGRAM}  diffuse.x    $(BINDIR)/diffuse.exe
+	${BSD_INSTALL_PROGRAM}  distgeom.x   $(BINDIR)/distgeom.exe
+	${BSD_INSTALL_PROGRAM}  document.x   $(BINDIR)/document.exe
+	${BSD_INSTALL_PROGRAM}  dynamic.x    $(BINDIR)/dynamic.exe
+	${BSD_INSTALL_PROGRAM}  freefix.x    $(BINDIR)/freefix.exe
+	${BSD_INSTALL_PROGRAM}  gda.x        $(BINDIR)/gda.exe
+	${BSD_INSTALL_PROGRAM}  intedit.x    $(BINDIR)/intedit.exe
+	${BSD_INSTALL_PROGRAM}  intxyz.x     $(BINDIR)/intxyz.exe
+	${BSD_INSTALL_PROGRAM}  minimize.x   $(BINDIR)/minimize.exe
+	${BSD_INSTALL_PROGRAM}  minirot.x    $(BINDIR)/minirot.exe
+	${BSD_INSTALL_PROGRAM}  minrigid.x   $(BINDIR)/minrigid.exe
+	${BSD_INSTALL_PROGRAM}  mol2xyz.x    $(BINDIR)/mol2xyz.exe
+	${BSD_INSTALL_PROGRAM}  molxyz.x     $(BINDIR)/molxyz.exe
+	${BSD_INSTALL_PROGRAM}  monte.x      $(BINDIR)/monte.exe
+	${BSD_INSTALL_PROGRAM}  newton.x     $(BINDIR)/newton.exe
+	${BSD_INSTALL_PROGRAM}  newtrot.x    $(BINDIR)/newtrot.exe
+	${BSD_INSTALL_PROGRAM}  nucleic.x    $(BINDIR)/nucleic.exe
+	${BSD_INSTALL_PROGRAM}  optimize.x   $(BINDIR)/optimize.exe
+	${BSD_INSTALL_PROGRAM}  optirot.x    $(BINDIR)/optirot.exe
+	${BSD_INSTALL_PROGRAM}  optrigid.x   $(BINDIR)/optrigid.exe
+	${BSD_INSTALL_PROGRAM}  path.x       $(BINDIR)/path.exe
+	${BSD_INSTALL_PROGRAM}  pdbxyz.x     $(BINDIR)/pdbxyz.exe
+	${BSD_INSTALL_PROGRAM}  polarize.x   $(BINDIR)/polarize.exe
+	${BSD_INSTALL_PROGRAM}  poledit.x    $(BINDIR)/poledit.exe
+	${BSD_INSTALL_PROGRAM}  potential.x  $(BINDIR)/potential.exe
+	${BSD_INSTALL_PROGRAM}  prmedit.x    $(BINDIR)/prmedit.exe
+	${BSD_INSTALL_PROGRAM}  protein.x    $(BINDIR)/protein.exe
+	${BSD_INSTALL_PROGRAM}  pss.x        $(BINDIR)/pss.exe
+	${BSD_INSTALL_PROGRAM}  pssrigid.x   $(BINDIR)/pssrigid.exe
+	${BSD_INSTALL_PROGRAM}  pssrot.x     $(BINDIR)/pssrot.exe
+	${BSD_INSTALL_PROGRAM}  radial.x     $(BINDIR)/radial.exe
+	${BSD_INSTALL_PROGRAM}  saddle.x     $(BINDIR)/saddle.exe
+	${BSD_INSTALL_PROGRAM}  scan.x       $(BINDIR)/scan.exe
+	${BSD_INSTALL_PROGRAM}  sniffer.x    $(BINDIR)/sniffer.exe
+	${BSD_INSTALL_PROGRAM}  spacefill.x  $(BINDIR)/spacefill.exe
+	${BSD_INSTALL_PROGRAM}  spectrum.x   $(BINDIR)/spectrum.exe
+	${BSD_INSTALL_PROGRAM}  superpose.x  $(BINDIR)/superpose.exe
+	${BSD_INSTALL_PROGRAM}  testgrad.x   $(BINDIR)/testgrad.exe
+	${BSD_INSTALL_PROGRAM}  testhess.x   $(BINDIR)/testhess.exe
+	${BSD_INSTALL_PROGRAM}  testpair.x   $(BINDIR)/testpair.exe
+	${BSD_INSTALL_PROGRAM}  testpol.x    $(BINDIR)/testpol.exe
+	${BSD_INSTALL_PROGRAM}  testrot.x    $(BINDIR)/testrot.exe
+	${BSD_INSTALL_PROGRAM}  testvir.x    $(BINDIR)/testvir.exe
+	${BSD_INSTALL_PROGRAM}  timer.x      $(BINDIR)/timer.exe
+	${BSD_INSTALL_PROGRAM}  timerot.x    $(BINDIR)/timerot.exe
+	${BSD_INSTALL_PROGRAM}  torsfit.x    $(BINDIR)/torsfit.exe
+	${BSD_INSTALL_PROGRAM}  valence.x    $(BINDIR)/valence.exe
+	${BSD_INSTALL_PROGRAM}  vibbig.x     $(BINDIR)/vibbig.exe
+	${BSD_INSTALL_PROGRAM}  vibrate.x    $(BINDIR)/vibrate.exe
+	${BSD_INSTALL_PROGRAM}  vibrot.x     $(BINDIR)/vibrot.exe
+	${BSD_INSTALL_PROGRAM}  xtalfit.x    $(BINDIR)/xtalfit.exe
+	${BSD_INSTALL_PROGRAM}  xtalmin.x    $(BINDIR)/xtalmin.exe
+	${BSD_INSTALL_PROGRAM}  xyzedit.x    $(BINDIR)/xyzedit.exe
+	${BSD_INSTALL_PROGRAM}  xyzint.x     $(BINDIR)/xyzint.exe
+	${BSD_INSTALL_PROGRAM}  xyzmol2.x    $(BINDIR)/xyzmol2.exe
+	${BSD_INSTALL_PROGRAM}  xyzpdb.x     $(BINDIR)/xyzpdb.exe
 
 remove_links:
 	rm -f $(LINKDIR)/alchemy
