PORTNAME=	sdl2_mixer
DISTVERSIONPREFIX=	release-
DISTVERSION=	2.8.0
CATEGORIES=	audio

MAINTAINER=	amdmi3@FreeBSD.org
COMMENT=	Sample multi-channel audio mixer library
WWW=		https://github.com/libsdl-org/SDL_mixer

LICENSE=	ZLIB
LICENSE_FILE=	${WRKSRC}/LICENSE.txt

USES=		cmake sdl
USE_GITHUB=	yes
GH_ACCOUNT=	libsdl-org
GH_PROJECT=	SDL_mixer
USE_SDL=	sdl2
CMAKE_OFF=	SDL2MIXER_SAMPLES \
		SDL2MIXER_DEPS_SHARED \
		SDL2MIXER_FLAC_LIBFLAC_SHARED \
		SDL2MIXER_MOD_MODPLUG_SHARED \
		SDL2MIXER_MOD_XMP_SHARED \
		SDL2MIXER_MP3_MPG123_SHARED \
		SDL2MIXER_MIDI_FLUIDSYNTH_SHARED \
		SDL2MIXER_OPUS_SHARED \
		SDL2MIXER_VORBIS_VORBISFILE_SHARED \
		SDL2MIXER_FLAC_DRFLAC \
		SDL2MIXER_MP3_MINIMP3 \
		SDL2MIXER_MIDI_TIMIDITY \
		SDL2MIXER_GME_SHARED \
		SDL2MIXER_WAVPACK_SHARED
CMAKE_ARGS=	-DSDL2MIXER_DEBUG_POSTFIX:STRING=
USE_LDCONFIG=	yes

OPTIONS_DEFINE=		FLAC OPUS MPG123 FLUIDSYNTH GME WAVPACK VORBIS
OPTIONS_RADIO=		MOD OGG
OPTIONS_RADIO_MOD=	MODPLUG XMP
OPTIONS_DEFAULT=	FLUIDSYNTH XMP OPUS MPG123 VORBIS

MOD_DESC=		Tracker music support

MODPLUG_LIB_DEPENDS=	libmodplug.so:audio/libmodplug
MODPLUG_CMAKE_BOOL=	SDL2MIXER_MOD_MODPLUG

XMP_DESC=		MOD music via libxmp
XMP_LIB_DEPENDS=	libxmp.so:audio/libxmp
XMP_CMAKE_BOOL=		SDL2MIXER_MOD_XMP

FLUIDSYNTH_LIB_DEPENDS=	libfluidsynth.so:audio/fluidsynth
FLUIDSYNTH_CMAKE_BOOL=	SDL2MIXER_MIDI SDL2MIXER_MIDI_FLUIDSYNTH
# TODO: add timidity?

VORBIS_LIB_DEPENDS=	libvorbisfile.so:audio/libvorbis
VORBIS_CMAKE_ON=	-DSDL2MIXER_VORBIS="VORBISFILE"
VORBIS_CMAKE_OFF=	-DSDL2MIXER_VORBIS=""

MPG123_LIB_DEPENDS=	libmpg123.so:audio/mpg123
MPG123_CMAKE_BOOL=	SDL2MIXER_MP3 SDL2MIXER_MP3_MPG123

FLAC_LIB_DEPENDS=	libFLAC.so:audio/flac
FLAC_CMAKE_BOOL=	SDL2MIXER_FLAC SDL2MIXER_FLAC_LIBFLAC

OPUS_LIB_DEPENDS=	libopusfile.so:audio/opusfile
OPUS_CMAKE_BOOL=	SDL2MIXER_OPUS

GME_LIB_DEPENDS=	libgme.so:audio/libgme
GME_CMAKE_BOOL=		SDL2MIXER_GME
GME_DESC=		WavPack DSD music support

WAVPACK_LIB_DEPENDS=	libwavpack.so:audio/wavpack
WAVPACK_CMAKE_BOOL=	SDL2MIXER_WAVPACK

.include <bsd.port.options.mk>

.if !${PORT_OPTIONS:MXMP} && !${PORT_OPTIONS:MMODPLUG}
CMAKE_OFF+=		SDL2MIXER_MOD
.endif

.include <bsd.port.mk>
