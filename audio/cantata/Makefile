# $FreeBSD$

PORTNAME=		cantata
PORTVERSION=		1.5.1
PORTREVISION=		3
CATEGORIES=		audio kde
MASTER_SITES=		https://drive.google.com/uc?export=download&id=0Bzghs6gQWi60UktwaTRMTjRIUW8&dummy=

MAINTAINER=		kde@FreeBSD.org
COMMENT=		Graphical client for MPD using Qt5

LICENSE=		GPLv3
LICENSE_FILE=		${WRKSRC}/LICENSE

USE_KDE4=		oxygen
USE_QT5=		buildtools_build concurrent core dbus gui \
			network qmake_build linguisttools svg widgets xml

FETCH_BEFORE_ARGS=	-o ${DISTFILES}

CMAKE_ARGS=		-DENABLE_QT5:BOOL=TRUE	\
			-DENABLE_KDE:BOOL=FALSE	\
			-DLCONVERT_EXECUTABLE:STRING=${QT_BINDIR}/lconvert \
			-DLRELEASE_EXECUTABLE:STRING=${QT_BINDIR}/lrelease

USES=			cmake:outsource cpe pkgconfig shebangfix tar:bzip2
SHEBANG_FILES=		dynamic/cantata-dynamic cantata-remote.cmake
CPE_VENDOR=		craig_drummond
USE_LDCONFIG=		yes

INSTALLS_ICONS=		yes

OPTIONS_DEFINE=		CDDB CDPARANOIA FFMPEG MPG123 MTP MUSICBRAINZ TAGLIB
OPTIONS_DEFAULT=	TAGLIB
OPTIONS_SUB=		yes

CDDB_LIB_DEPENDS=	libcddb.so:audio/libcddb
CDDB_CMAKE_ON=		-DENABLE_CDDB:BOOL=TRUE
CDDB_CMAKE_OFF=		-DENABLE_CDDB:BOOL=FALSE

CDPARANOIA_LIB_DEPENDS=	libcdda_interface.so:audio/cdparanoia
CDPARANOIA_CMAKE_ON=	-DENABLE_CDPARANOIA:BOOL=TRUE
CDPARANOIA_CMAKE_OFF=	-DENABLE_CDPARANOIA:BOOL=FALSE

FFMPEG_LIB_DEPENDS=	libavcodec.so:multimedia/ffmpeg
FFMPEG_CMAKE_ON=	-DENABLE_FFMPEG:BOOL=TRUE
FFMPEG_CMAKE_OFF=	-DENABLE_FFMPEG:BOOL=FALSE

MPG123_LIB_DEPENDS=	libmpg123.so:audio/mpg123
MPG123_CMAKE_ON=	-DENABLE_MPG123:BOOL=TRUE
MPG123_CMAKE_OFF=	-DENABLE_MPG123:BOOL=FALSE

MTP_LIB_DEPENDS=	libmtp.so:multimedia/libmtp
MTP_CMAKE_ON=		-DENABLE_MTP:BOOL=TRUE
MTP_CMAKE_OFF=		-DENABLE_MTP:BOOL=FALSE

MUSICBRAINZ_LIB_DEPENDS=libmusicbrainz5.so:audio/libmusicbrainz5
MUSICBRAINZ_CMAKE_ON=	-DENABLE_MUSICBRAINZ:BOOL=TRUE
MUSICBRAINZ_CMAKE_OFF=	-DENABLE_MUSICBRAINZ:BOOL=FALSE
MUSICBRAINZ_DESC=	Access MusicBrainz database for metadata lookup

TAGLIB_LIB_DEPENDS=	libtag.so:audio/taglib\
			libtag-extras.so:audio/taglib-extras
TAGLIB_CMAKE_ON=	-DENABLE_TAGLIB_EXTRAS:BOOL=TRUE \
			-DENABLE_TAGLIB:BOOL=TRUE
TAGLIB_CMAKE_OFF=	-DENABLE_TAGLIB_EXTRAS:BOOL=FALSE \
			-DENABLE_TAGLIB:BOOL=FALSE
TAGLIB_DESC=		Reading and editing Meta-Data of audio files

.include <bsd.port.options.mk>

.if ${PORT_OPTIONS:MTAGLIB} && ( ${PORT_OPTIONS:MFFMPEG} || ${PORT_OPTIONS:MMPG123} )
PLIST_SUB+=		REPLAYGAIN=""
.else
PLIST_SUB+=		REPLAYGAIN="@comment "
.endif

.include <bsd.port.mk>
