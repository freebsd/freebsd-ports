PORTNAME=	sdl_audiolib
PORTVERSION=	git20220713
PORTREVISION=	2
CATEGORIES=	audio

MAINTAINER=	amdmi3@FreeBSD.org
COMMENT=	Audio decoding, resampling and mixing library for SDL
WWW=		https://github.com/realnc/SDL_audiolib

LICENSE=	LGPL3+
LICENSE_FILE=	${WRKSRC}/COPYING.LESSER

LIB_DEPENDS=	libfmt.so:devel/libfmt

USES=		cmake pkgconfig sdl
USE_GITHUB=	yes
GH_ACCOUNT=	realnc
GH_PROJECT=	SDL_audiolib
GH_TAGNAME=	cc1bb6a
USE_SDL=	sdl2
USE_LDCONFIG=	yes
CMAKE_ON=	WITH_SYSTEM_FMTLIB
CMAKE_OFF=	USE_DEC_BASSMIDI USE_DEC_ADLMIDI  # not in ports (yet)?

PORTDOCS=	*

OPTIONS_DEFINE=			DOCS
OPTIONS_GROUP=			RESAMPLERS DECODERS
OPTIONS_GROUP_RESAMPLERS=	SAMPLERATE SOXR
OPTIONS_GROUP_DECODERS=		OPENMPT XMP MODPLUG MPG123 SNDFILE VORBIS OPUS FLAC MUSEPACK FLUIDSYNTH WILDMIDI
OPTIONS_DEFAULT=	${OPTIONS_GROUP_RESAMPLERS} ${OPTIONS_GROUP_DECODERS}
OPTIONS_SUB=		yes

RESAMPLERS_DESC=	Resamplers

SAMPLERATE_LIB_DEPENDS=	libsamplerate.so:audio/libsamplerate
SAMPLERATE_CMAKE_BOOL=	USE_RESAMP_SRC

SOXR_LIB_DEPENDS=	libsoxr.so:audio/libsoxr
SOXR_CMAKE_BOOL=	USE_RESAMP_SOXR

DECODERS_DESC=		Decoders

OPENMPT_DESC=		OpenMPT MOD decoder
OPENMPT_LIB_DEPENDS=	libopenmpt.so:audio/libopenmpt
OPENMPT_CMAKE_BOOL=	USE_DEC_OPENMPT

XMP_DESC=		XMP MOD decoder
XMP_LIB_DEPENDS=	libxmp.so:audio/libxmp
XMP_CMAKE_BOOL=		USE_DEC_XMP

MODPLUG_LIB_DEPENDS=	libmodplug.so:audio/libmodplug
MODPLUG_CMAKE_BOOL=	USE_DEC_MODPLUG

MPG123_LIB_DEPENDS=	libmpg123.so:audio/mpg123
MPG123_CMAKE_BOOL=	USE_DEC_MPG123

SNDFILE_LIB_DEPENDS=	libsndfile.so:audio/libsndfile
SNDFILE_CMAKE_BOOL=	USE_DEC_SNDFILE

VORBIS_LIB_DEPENDS=	libvorbisfile.so:audio/libvorbis
VORBIS_CMAKE_BOOL=	USE_DEC_LIBVORBIS

OPUS_LIB_DEPENDS=	libopusfile.so:audio/opusfile
OPUS_CMAKE_BOOL=	USE_DEC_LIBOPUSFILE

FLAC_LIB_DEPENDS=	libFLAC.so:audio/flac
FLAC_CMAKE_BOOL=	USE_DEC_FLAC

MUSEPACK_LIB_DEPENDS=	libmpcdec.so:audio/musepack
MUSEPACK_CMAKE_BOOL=	USE_DEC_MUSEPACK

FLUIDSYNTH_LIB_DEPENDS=	libfluidsynth.so:audio/fluidsynth
FLUIDSYNTH_CMAKE_BOOL=	USE_DEC_FLUIDSYNTH

WILDMIDI_DESC=		WildMIDI MIDI decoder
WILDMIDI_LIB_DEPENDS=	libWildMidi.so:audio/wildmidi
WILDMIDI_CMAKE_BOOL=	USE_DEC_WILDMIDI

post-install-DOCS-on:
	@${MKDIR} ${STAGEDIR}${DOCSDIR}
	${INSTALL_DATA} ${WRKSRC}/README.md ${STAGEDIR}${DOCSDIR}/

.include <bsd.port.mk>
