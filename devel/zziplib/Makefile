PORTNAME=	zziplib
PORTVERSION=	0.13.74
DISTVERSIONPREFIX=	v
CATEGORIES=	devel

MAINTAINER=	sunpoet@FreeBSD.org
COMMENT=	Library to provide transparent read access to zipped files
WWW=		https://github.com/gdraheim/zziplib

LICENSE=	LGPL21 MPL11
LICENSE_COMB=	dual
LICENSE_FILE_LGPL21=	${WRKSRC}/COPYING.LIB
LICENSE_FILE_MPL11=	${WRKSRC}/docs/COPYING.MPL

BUILD_DEPENDS=	bash:shells/bash

USES=		cmake compiler:c11 cpe pathfix

CMAKE_OFF=	FORTIFY MSVC_STATIC_RUNTIME ZZIP_COMPAT ZZIP_LIBLATEST ZZIP_LIBTOOL
CMAKE_ON=	BUILD_SHARED_LIBS ZZIP_PKGCONFIG ZZIPBINS ZZIPFSEEKO ZZIPMMAPPED ZZIPWRAP
TEST_TARGET=	check
USE_LDCONFIG=	yes

CPE_VENDOR=	zziplib_project

USE_GITHUB=	yes
GH_ACCOUNT=	gdraheim

PORTSCOUT=	limit:^0\.

OPTIONS_DEFINE=	MANPAGES SDL TEST
OPTIONS_DEFAULT=MANPAGES
OPTIONS_SUB=	yes

MANPAGES_CMAKE_ARGS=	-DZZIP_HTMLSITE=OFF -DZZIP_HTMPAGES=OFF -DZZIP_MANPAGES=ON
MANPAGES_CMAKE_BOOL=	ZZIPDOCS
MANPAGES_USES=		python:build shebangfix
MANPAGES_VARS=		SHEBANG_GLOB=*.py
SDL_CMAKE_BOOL=		ZZIPSDL
SDL_USE=		SDL=sdl2
SDL_USES=		localbase:ldflags pkgconfig sdl
TEST_BUILD_DEPENDS=	zip:archivers/zip
TEST_CMAKE_BOOL=	BUILD_TESTS ZZIPTEST
TEST_CMAKE_BOOL_OFF=	ZZIP_TESTCVE

.include <bsd.port.mk>
