# Created by: ijliao
# $FreeBSD$

PORTNAME=	ptypes
PORTVERSION=	2.1.1
CATEGORIES=	devel
MASTER_SITES=	SF/${PORTNAME}/${PORTNAME}/${PORTNAME}-${PORTVERSION}

MAINTAINER=	ports@FreeBSD.org
COMMENT=	C++ Portable Types Library

LICENSE=	BSD3CLAUSE
LICENSE_FILE=	${WRKSRC}/LICENSE

SHLIB_VER=	21

PTYPES_CFLAGS=	${CFLAGS}
MAKE_ARGS=	DEBUG_FLAGS="${DEBUG_FLAGS}" PTYPES_CFLAGS="${PTYPES_CFLAGS}"
PLIST_SUB=	SHLIB_VER=${SHLIB_VER}
MAKE_JOBS_UNSAFE=	yes
USE_LDCONFIG=	yes

PORTDOCS=	*
PORTEXAMPLES=	*

OPTIONS_DEFINE=	DEBUG OPTIMIZED_CFLAGS DOCS EXAMPLES

DEBUG_VARS=		DEBUG_FLAGS="-DDEBUG -g"
OPTIMIZED_CFLAGS_VARS=	PTYPES_CFLAGS+="-O2"

pre-install:
	@${RM} ${WRKSRC}/include/*.orig
	@${RM} ${WRKSRC}/wshare/*.o ${WRKSRC}/wshare/*.orig

do-install:
	@${MKDIR} ${STAGEDIR}${PREFIX}/include/ptypes
	${INSTALL_DATA} ${WRKSRC}/include/* ${STAGEDIR}${PREFIX}/include/ptypes
	@${MKDIR} ${STAGEDIR}${PREFIX}/lib
	${INSTALL_LIB} ${WRKSRC}/so/libptypes.so.${SHLIB_VER} ${STAGEDIR}${PREFIX}/lib
	${LN} -sf libptypes.so.${SHLIB_VER} ${STAGEDIR}${PREFIX}/lib/libptypes.so
	${INSTALL_DATA} ${WRKSRC}/lib/* ${STAGEDIR}${PREFIX}/lib

do-install-EXAMPLES-on:
	@${MKDIR} ${STAGEDIR}${EXAMPLESDIR}/wshare
	${INSTALL_DATA} ${WRKSRC}/wshare/*.* ${STAGEDIR}${EXAMPLESDIR}/wshare
	${INSTALL_PROGRAM} ${WRKSRC}/wshare/wshare ${STAGEDIR}${EXAMPLESDIR}/wshare

do-install-DOCS-on:
	@${MKDIR} ${STAGEDIR}${DOCSDIR}/doc
	cd ${WRKSRC} && ${COPYTREE_SHARE} "index.html doc" ${STAGEDIR}${DOCSDIR}

.include <bsd.port.mk>
