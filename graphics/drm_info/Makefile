PORTNAME=	drm_info
DISTVERSIONPREFIX=	v
DISTVERSION=	2.5.0
CATEGORIES=	graphics

MAINTAINER=	jbeich@FreeBSD.org
COMMENT=	Small utility to dump info about DRM devices
WWW=		https://gitlab.freedesktop.org/emersion/drm_info

LICENSE=	MIT
LICENSE_FILE=	${WRKSRC}/LICENSE

LIB_DEPENDS=	libjson-c.so:devel/json-c \
		libdrm.so:graphics/libdrm

USES=		compiler:c11 meson pkgconfig
USE_GITLAB=	yes
GL_SITE=	https://gitlab.freedesktop.org
GL_ACCOUNT=	emersion
GL_COMMIT=	f819ac496d1d9aa5dc5e50bb3bd60dfbd0030ae6
PLIST_FILES=	bin/${PORTNAME}

# XXX Drop after graphics/libdrm >= 2.4.115,1
# https://gitlab.freedesktop.org/emersion/drm_info/-/commit/d28844dce8e1
GL_TUPLE=	mesa:drm:ee558cea20d1f9d822fe1a28e97beaf365bf9d38:libdrm/subprojects/libdrm

OPTIONS_DEFINE=	MANPAGES PCI
OPTIONS_DEFAULT=MANPAGES PCI

MANPAGES_BUILD_DEPENDS=	scdoc:textproc/scdoc
MANPAGES_MESON_ENABLED=	man-pages
MANPAGES_PLIST_FILES=	man/man1/${PORTNAME}.1.gz

PCI_DESC=		Print PCI device names via libpci
PCI_LIB_DEPENDS=	libpci.so:devel/libpci
PCI_MESON_ENABLED=	libpci

.include <bsd.port.mk>
