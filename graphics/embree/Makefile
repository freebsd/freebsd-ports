# Created by: Alexey Dokuchaev <danfe@FreeBSD.org>
# $FreeBSD$

PORTNAME=	embree
PORTVERSION=	2.12.0
PORTREVISION=	1
DISTVERSIONPREFIX=	v
CATEGORIES=	graphics

MAINTAINER=	danfe@FreeBSD.org
COMMENT=	Collection of high-performance ray tracing kernels

LICENSE=	APACHE20

ONLY_FOR_ARCHS=	i386 amd64
ONLY_FOR_ARCHS_REASON=	heavy use of SSE instructions

USE_GITHUB=	yes

USES=		cmake
USE_GL=		glut
USE_XORG=	xmu
USE_LDCONFIG=	yes

CMAKE_ARGS=	-DEMBREE_TASKING_SYSTEM:STRING=INTERNAL \
		-DEMBREE_ISPC_SUPPORT:BOOL=OFF

CXXFLAGS+=	-msse2					# required on i386

DOCSDIR=	${PREFIX}/share/doc/${PORTNAME}2
PLIST_SUB+=	VERSION=${DISTVERSION}

OPTIONS_DEFINE=	IMAGEMAGICK JPEG OPENEXR PNG
IMAGEMAGICK_DESC=	BMP, GIF, PNG, TGA, TIFF image formats support

IMAGEMAGICK_LIB_DEPENDS=	libMagick++-6.so:graphics/ImageMagick
IMAGEMAGICK_CMAKE_ON=	-DEMBREE_TUTORIALS_IMAGE_MAGICK:BOOL=ON

JPEG_USES=		jpeg
JPEG_CMAKE_OFF=		-DEMBREE_TUTORIALS_LIBJPEG:BOOL=OFF

OPENEXR_LIB_DEPENDS=	libIlmImf.so:graphics/OpenEXR
OPENEXR_CMAKE_OFF=	-DEMBREE_TUTORIALS_OPENEXR:BOOL=OFF

PNG_LIB_DEPENDS=	libpng.so:graphics/png
PNG_CMAKE_OFF=		-DEMBREE_TUTORIALS_LIBPNG:BOOL=OFF

.include <bsd.port.mk>
