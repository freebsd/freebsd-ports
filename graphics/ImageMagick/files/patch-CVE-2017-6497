From 7f2dc7a1afc067d0c89f12c82bcdec0445fb1b94 Mon Sep 17 00:00:00 2001
From: Dirk Lemstra <dirk@git.imagemagick.org>
Date: Sat, 11 Feb 2017 10:31:39 +0100
Subject: [PATCH] Added missing null check.

---
 coders/psd.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/coders/psd.c b/coders/psd.c
index 14e375b9ed..fb93c57dd1 100644
--- coders/psd.c
+++ coders/psd.c
@@ -1284,8 +1284,11 @@ static MagickBooleanType ReadPSDChannel(Image *image,
       }
       mask=CloneImage(image,layer_info->mask.page.width,
         layer_info->mask.page.height,MagickFalse,exception);
-      mask->matte=MagickFalse;
-      channel_image=mask;
+      if (mask != (Image *) NULL)
+        {
+          mask->matte=MagickFalse;
+          channel_image=mask;
+        }
     }
 
   offset=TellBlob(image);
