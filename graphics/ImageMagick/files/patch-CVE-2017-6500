From 3007531bfd326c5c1e29cd41d2cd80c166de8528 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Wed, 8 Feb 2017 13:38:04 -0500
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/375
 https://github.com/ImageMagick/ImageMagick/issues/376

---
 coders/sun.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/coders/sun.c b/coders/sun.c
index 150f3357fd..c11a33c62b 100644
--- coders/sun.c
+++ coders/sun.c
@@ -458,7 +458,7 @@ static Image *ReadSUNImage(const ImageInfo *image_info,ExceptionInfo *exception)
         ThrowReaderException(ResourceLimitError,"ImproperImageHeader");
       }
     pixels_length=height*bytes_per_line;
-    sun_pixels=(unsigned char *) AcquireQuantumMemory(pixels_length,
+    sun_pixels=(unsigned char *) AcquireQuantumMemory(pixels_length+image->rows,
       sizeof(*sun_pixels));
     if (sun_pixels == (unsigned char *) NULL)
       {
